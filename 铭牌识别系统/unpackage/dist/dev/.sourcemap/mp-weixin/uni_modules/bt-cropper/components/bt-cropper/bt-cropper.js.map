{"version":3,"sources":["webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?a575","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?a909","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?7f53","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?44a5","uni-app:///uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?dd24","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?7be6","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?f92a","webpack:///E:/github/jieneng/铭牌识别系统/uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue?3623"],"names":["name","props","imageSrc","type","default","required","mask","containerSize","fileType","dWidth","maxWidth","ratio","validator","rotate","showGrid","quality","canvas2d","initPosition","autoZoom","data","canvasId","containerRect","imageInfo","operationHistory","operationIndex","anim","timer","type2d","pixel","imageRect","cropperRect","target","width","height","watch","handler","immediate","computed","containerStyle","rotateAngle","methods","startAnim","stopAnim","clearTimeout","imageInit","uni","title","src","success","fail","icon","complete","initCropper","cropperRate","init","left","top","setTarget","addHistory","updateData","getContainer","query","select","boundingClientRect","resolve","exec","zoomToFill","onTouchStart","undo","resume","drawImage","ctx","path","crop","node","canvas","scale","dx","dy","image","x","y","w","h","imageData","maskData","alpha","params","destWidth","destHeight","console","reject"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2ob;AAC3ob;AAC8D;AACL;AACsC;;;AAG/F;AAC+M;AAC/M,gBAAgB,gNAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,ymbAAM;AACR,EAAE,knbAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,6mbAAU;AACZ;AACA;;AAEA;AACwG;AACxG,WAAW,0HAAM,iBAAiB,kIAAM;;AAExC;AACe,gF;;;;;;;;;;;;AC3Bf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAm0B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;ACuEv1B;AAAA;AAAA;AACA;AACA;AACA;AAFA,gBAGA;EACAA;EACAC;IACA;IACAC;MACAC;MACAC;MACAC;IACA;IACAC;MACAH;MACAC;IACA;IACA;IACAG;MACAJ;MACAC;IACA;IACA;IACAI;MACAL;MACAC;IACA;IACA;IACAK;IACAC;MACAP;MACAC;IACA;IACA;IACAO;MACAR;MACAC;MACAQ;QACA;UACA;YACA;UACA;QACA;UACA;QACA;QACA;MACA;IACA;IACA;IACAC;IACA;IACAC;MACAX;MACAC;IACA;IACA;IACAW;MACAZ;MACAC;IACA;IACAY;MACAb;MACAC;IACA;IACA;IACAa;MACAd;MACAC;QACA;MACA;IACA;IACA;IACAc;MACAf;MACAC;IACA;EACA;EAIAe;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAhC;MACAiC;QACA;UACA;QACA;UACA;QACA;MACA;MACAC;IACA;IACAzB;MACA;QACA;QACA;MACA;IACA;EACA;EACA0B;IACAC;MACA;QACA;UACAN;UACAC;QACA;MACA;MACA;IACA;IACAM;MACA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;MACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACAC;IACA;IACAC;MAAA;MACAC;QACAC;MACA;MACAD;QACAE;QACAC;UACA;UACA;YACA;cACA;cACA;YACA;UACA;QACA;QACAC;UACA;UACAJ;YACAC;YACAI;UACA;QACA;QACAC;UACAN;QACA;MACA;IACA;IACAO;MACA;MACA;MACA;MACA;MACA;QACA;UACAC;QACA;UACAA;QACA;MACA;MACA;MACA;QACAvB;QACAA;MACA;QACAA;QACAA;MACA;MACA;QACAD;QACAA;MACA;QACAA;QACAA;MACA;MACAA;MACAA;MACAC;MACAA;MACA;QACAD;QACAC;MACA;IACA;IACAwB;MACA;QAAAzB;QAAAC;MACA;QACA;QACA;UAAAyB;UAAAC;UAAAxB;UAAAC;QACA;UACAH;UACAA;UACAA;UACAA;UACA;QACA;MACA;MACA;MACA;MACA;QAAAD;QAAAC;MAAA;MACA;MACA;MAEA;MACA;QACA;MACA;QACA;QACA;MACA;;MAEA;IAOA;IACA;IACA2B;MACA;MACA;QACA;UACAzB;UACAC;QACA;MACA;QACA;QACA;UACAD;UACAC;QACA;MACA;IACA;IACAyB;MAAA;QAAA5B;MACA;QACA;MACA;MACA;QACAD;QACAC;MACA;MACA;QACA;MACA;MACA;IACA;IACA6B;MAAA;MACA;MACA;MACA;MACA;MACA;QACA;UACA;QACA;MACA;MACA;QAAA7B;MACA;MACA;QACAyB;QACAC;QACAxB;QACAC;MACA;IACA;IACA2B;MAAA;MACA;QACA;UAAA5B;UAAAC;QACA;UACAD;UACAC;QACA;MACA;QACA;UACA;UACA4B,MACAC,uBACAC;YACAC;UACA,GACAC;QACA;MACA;IACA;IACAC;MACA;MACA,sCACA,iBACA;MACA;QACArC;QACAC;MACA;MACA;MACA;MACA;MACA;MACA;QACAE;QACAC;QACAsB;QACAC;MACA;IACA;IACAW;MACA;IACA;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;kBAAA;gBAAA;cAAA;gBACAC;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;kBACA1B;oBACAE;oBACAC;sBAAA;sBACAgB;oBACA;kBACA;gBACA;cAAA;gBAPAQ;gBAQAD;gBAAA;gBAAA,OACA;kBAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAGA;gBACA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBACAZ;gBAAA;gBAAA,OACA;kBAAA,OACAA,MACAC,qBACAY;oBAAA;oBAAA;kBAAA,GACAT;gBAAA,EACA;cAAA;gBALAU;gBAMAA;gBACAA;gBACAJ;gBAAA;gBAAA;cAAA;gBAOAA;cAAA;gBAEAK;gBACAC;gBACAC;gBAEA;kBACAC;kBACAA;gBACA;kBACAA;gBACA;gBACAC,SACAC,SACAC,oCACAC;gBACAZ;gBACAA;gBACAA;gBACAA;gBAAA;gBAAA,OACA;cAAA;gBACAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBAAA,KAEA;kBAAA;kBAAA;gBAAA;gBACAa;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;kBACAvC;oBACAzB;oBACA4D;oBACAC;oBACAjD;oBACAC;oBACAe;sBACAgB;oBACA;kBACA;gBACA;cAAA;gBAXAoB;cAAA;gBAaAb;gBACA;kBACAQ;gBACA;kBACAA;gBACA;gBAAA;gBAAA,OACA;cAAA;gBAAA,KAEA;kBAAA;kBAAA;gBAAA;gBACAM;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;kBACAxC;oBACAzB;oBACA4D;oBACAC;oBACAjD;oBACAC;oBACAe;sBACAgB;oBACA;kBACA;gBACA;cAAA;gBAXAqB;cAAA;gBAaAd;gBACA;kBACAe;kBACA;oBACAF;kBACA;gBACA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBACAb;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;kBACA1B;oBACAzB;oBACA4D;oBACAC;oBACAjD;oBACAC;oBACAd;oBACAgC;sBACAa;oBACA;kBACA;gBACA;cAAA;gBAAA,kCAGA;kBACA;kBACA;oBACAuB;kBACA;oBACAA;kBACA;kBAEA1C,yDACA0C;oBACAC;oBACAC;oBACA1E;oBACAP;oBACAwC;sBAAA;sBAmBAgB;oBACA;oBACAf;sBACAyC;sBACAC;oBACA;kBAAA,IACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;EACA;AACA;AAAA,4B;;;;;;;;;;;;;ACvlBA;AAAA;AAAA;AAAA;AAAsjD,CAAgB,s7CAAG,EAAC,C;;;;;;;;;;;ACA1kD;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;ACNL;AAAA;AAAA,wCAAslB,CAAgB,omBAAG,EAAC,C;;;;;;;;;;;;ACA1mB;AAAe;AACf;AACA;AACA;AACA;AACA;AACA,M","file":"uni_modules/bt-cropper/components/bt-cropper/bt-cropper.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./bt-cropper.vue?vue&type=template&id=db75b244&scoped=true&filter-modules=eyJ3eHNNb2R1bGUiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiJ2YXIgc3RhcnRUb3VjaHMgPSBbXTtcclxudmFyIHN0YXJ0RGlzdGFuY2UgPSAwO1xyXG52YXIgdG91Y2hDZW50ZXIgPSBbXTtcclxudmFyIHJhdGlvID0gMDtcclxudmFyIGltYWdlSW5zdGFuY2UgPSBudWxsO1xyXG52YXIgY3JvcHBlckluc3RhbmNlID0gbnVsbDtcclxudmFyIHRvdWNoVHlwZSA9IFwiXCI7XHJcbnZhciB0b3VjaEluc3RhbmNlID0gbnVsbDtcclxudmFyIGNyb3BwZXJSZWN0ID0gbnVsbDtcclxudmFyIGltYWdlUmVjdCA9IG51bGw7XHJcbi8vIOaXi%2Bi9rOinkuW6plxyXG52YXIgcm90YXRlQW5nbGUgPSAwO1xyXG4vLyDmk43kvZzml7bmlLnlj5jnmoTlr7nosaFcclxudmFyIGNoYW5nZXMgPSB7XHJcblx0aW1hZ2VSZWN0OiBudWxsLFxyXG5cdGNyb3BwZXJSZWN0OiBudWxsXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUltYWdlU3R5bGUoKSB7XHJcblx0dmFyIGltYWdlUmVjdCA9IGNoYW5nZXMuaW1hZ2VSZWN0XHJcblx0aW1hZ2VJbnN0YW5jZS5zZXRTdHlsZSh7XHJcblx0XHRsZWZ0OiBpbWFnZVJlY3QubGVmdCArICdweCcsXHJcblx0XHR0b3A6IGltYWdlUmVjdC50b3AgKyAncHgnLFxyXG5cdFx0d2lkdGg6IGltYWdlUmVjdC53aWR0aCArICdweCcsXHJcblx0XHRoZWlnaHQ6IGltYWdlUmVjdC5oZWlnaHQgKyAncHgnLFxyXG5cdFx0dHJhbnNmb3JtOiAncm90YXRlKCcgKyByb3RhdGVBbmdsZSArICdkZWcpJ1xyXG5cdH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUNvcHBlclN0eWxlKCkge1xyXG5cdHZhciBjcm9wcGVyUmVjdCA9IGNoYW5nZXMuY3JvcHBlclJlY3RcclxuXHRjcm9wcGVySW5zdGFuY2Uuc2V0U3R5bGUoe1xyXG5cdFx0bGVmdDogY3JvcHBlclJlY3QubGVmdCArIFwicHhcIixcclxuXHRcdHRvcDogY3JvcHBlclJlY3QudG9wICsgXCJweFwiLFxyXG5cdFx0d2lkdGg6IGNyb3BwZXJSZWN0LndpZHRoICsgXCJweFwiLFxyXG5cdFx0aGVpZ2h0OiBjcm9wcGVyUmVjdC5oZWlnaHQgKyBcInB4XCJcclxuXHR9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbWFnZVNjYWxlKHNjYWxlUmF0ZSkge1xyXG5cdHZhciBjdyA9IGltYWdlUmVjdC53aWR0aCAqIChzY2FsZVJhdGUgLSAxKVxyXG5cdHZhciBjaCA9IGltYWdlUmVjdC5oZWlnaHQgKiAoc2NhbGVSYXRlIC0gMSlcclxuXHRjaGFuZ2VzLmltYWdlUmVjdCA9IHtcclxuXHRcdHdpZHRoOiBpbWFnZVJlY3Qud2lkdGggKyBjdyxcclxuXHRcdGhlaWdodDogaW1hZ2VSZWN0LmhlaWdodCArIGNoLFxyXG5cdFx0bGVmdDogaW1hZ2VSZWN0LmxlZnQgLSBjdyAqICh0b3VjaENlbnRlclswXSksXHJcblx0XHR0b3A6IGltYWdlUmVjdC50b3AgLSBjaCAqICh0b3VjaENlbnRlclsxXSlcclxuXHR9XHJcbn1cclxuZnVuY3Rpb24gZ2V0SW1hZ2VSb3RhdGVTaXplQ2hhbmdlKHcsaCl7XHJcblx0dmFyIGN3ID0gaCpNYXRoLnNpbihyb3RhdGVBbmdsZS8xODAgKiBNYXRoLlBJKVxyXG5cdHZhciBjaCA9IHcqTWF0aC5zaW4ocm90YXRlQW5nbGUvMTgwICogTWF0aC5QSSlcclxuXHRyZXR1cm4ge2N3LGNofVxyXG59XHJcbi8vIOinkuW6pui9rOW8p%2BW6plxyXG5mdW5jdGlvbiBhbmcyZGVnKGFuZyl7XHJcblx0cmV0dXJuIGFuZy8xODAqTWF0aC5QSVxyXG59XHJcbi8vIOiuoeeul%2BaXi%2Bi9rOWQjuecn%2BWunueahOWbvueJh%2BWkp%2BWwj1xyXG5mdW5jdGlvbiBnZXRSZWFsU2l6ZSgpe1xyXG5cdHZhciB3ID0gY2hhbmdlcy5pbWFnZVJlY3Qud2lkdGhcclxuXHR2YXIgaCA9IGNoYW5nZXMuaW1hZ2VSZWN0LmhlaWdodFxyXG5cdHZhciBsID0gIGNoYW5nZXMuaW1hZ2VSZWN0LmxlZnRcclxuXHR2YXIgdCA9ICBjaGFuZ2VzLmltYWdlUmVjdC50b3BcclxuXHQvLyDlhoXmlpzovrlcclxuXHR2YXIgUiA9IE1hdGguc3FydCh3KncraCpoKVxyXG5cdHZhciBhbmdsZSA9IE1hdGguYXRhbihoL3cpIC8gTWF0aC5QSSAqIDE4MFxyXG5cdHZhciByb3JhdGUgPSByb3RhdGVBbmdsZSU5MFxyXG5cdHZhciBkaXJlY3QgPSBNYXRoLmZsb29yKHJvdGF0ZUFuZ2xlLzkwKVxyXG5cdHZhciB3aWR0aCA9IFIqTWF0aC5jb3MoYW5nMmRlZyhhbmdsZS1yb3JhdGUpKVxyXG5cdHZhciBoZWlnaHQgPSBSKk1hdGguc2luKGFuZzJkZWcoYW5nbGUrcm9yYXRlKSlcclxuXHRpZihkaXJlY3QgJSAyID09PSAxKXtcclxuXHRcdHZhciB0ZW1wID0gd2lkdGhcclxuXHRcdHdpZHRoID0gaGVpZ2h0XHJcblx0XHRoZWlnaHQgPSB0ZW1wXHJcblx0fVxyXG5cdHJldHVybiB7XHJcblx0XHR3aWR0aDogd2lkdGgsXHJcblx0XHRoZWlnaHQ6IGhlaWdodCxcclxuXHRcdGxlZnQ6IGwgLSAod2lkdGggLSB3KS8yLFxyXG5cdFx0dG9wOiB0IC0gKGhlaWdodCAtIGgpLzIsXHJcblx0XHRkdzogd2lkdGggLSB3LFxyXG5cdFx0ZGg6IGhlaWdodCAtIGhcclxuXHR9XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcblx0dG91Y2hTdGFydDogZnVuY3Rpb24gKGV2LCBvaSkge1xyXG5cclxuXHJcblxyXG5cclxuXHRcdHRvdWNoSW5zdGFuY2UgPSBldi5pbnN0YW5jZTtcclxuXHRcdHZhciBkYXRhU2V0ID0gZXYuaW5zdGFuY2UuZ2V0RGF0YXNldCgpXHJcblx0XHR0b3VjaFR5cGUgPSBkYXRhU2V0LnR5cGU7XHJcblx0XHRzdGFydFRvdWNocyA9IGV2LnRvdWNoZXM7XHJcblx0XHRvaS5jYWxsTWV0aG9kKCdvblRvdWNoU3RhcnQnKVxyXG5cdFx0aWYgKHN0YXJ0VG91Y2hzLmxlbmd0aCA9PSAyKSB7XHJcblx0XHRcdHRvdWNoVHlwZSA9IFwiaW1hZ2VcIlxyXG5cdFx0XHR2YXIgeDEgPSBzdGFydFRvdWNoc1swXS5jbGllbnRYXHJcblx0XHRcdHZhciB5MSA9IHN0YXJ0VG91Y2hzWzBdLmNsaWVudFlcclxuXHRcdFx0dmFyIHgyID0gc3RhcnRUb3VjaHNbMV0uY2xpZW50WFxyXG5cdFx0XHR2YXIgeTIgPSBzdGFydFRvdWNoc1sxXS5jbGllbnRZXHJcblx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucG93KHgyIC0geDEsIDIpICsgTWF0aC5wb3coeTIgLSB5MSwgMilcclxuXHRcdFx0c3RhcnREaXN0YW5jZSA9IE1hdGguc3FydChkaXN0YW5jZSlcclxuXHRcdFx0dmFyIGxlZnRQZXJjZW50ID0gKCh4MSArIHgyKSAvIDIgLSBpbWFnZVJlY3QubGVmdCkgLyBpbWFnZVJlY3Qud2lkdGhcclxuXHRcdFx0dmFyIHRvcFBlcmNlbnQgPSAoKHkxICsgeTIpIC8gMiAtIGltYWdlUmVjdC50b3ApIC8gaW1hZ2VSZWN0LmhlaWdodFxyXG5cdFx0XHR0b3VjaENlbnRlciA9IFtsZWZ0UGVyY2VudCwgdG9wUGVyY2VudF1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cdHRvdWNoTW92ZTogZnVuY3Rpb24gKGV2LCBpbykge1xyXG5cdFx0aWYgKHRvdWNoVHlwZSA9PSBcIlwiKSByZXR1cm4gZmFsc2VcclxuXHJcblxyXG5cclxuXHJcblx0XHR2YXIgdG91Y2hlcyA9IGV2LnRvdWNoZXM7XHJcblx0XHR2YXIgY2hhbmdlWDEgPSB0b3VjaGVzWzBdLmNsaWVudFggLSBzdGFydFRvdWNoc1swXS5jbGllbnRYO1xyXG5cdFx0dmFyIGNoYW5nZVkxID0gdG91Y2hlc1swXS5jbGllbnRZIC0gc3RhcnRUb3VjaHNbMF0uY2xpZW50WTtcclxuXHRcdGlmIChzdGFydFRvdWNocy5sZW5ndGggPT0gMSkge1xyXG5cdFx0XHRpZiAodG91Y2hUeXBlID09PSAnaW1hZ2UnKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QubGVmdCA9IGltYWdlUmVjdC5sZWZ0ICsgY2hhbmdlWDE7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QudG9wID0gaW1hZ2VSZWN0LnRvcCArIGNoYW5nZVkxO1xyXG5cdFx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0XHR9IGVsc2UgaWYgKHRvdWNoVHlwZSA9PT0gJ2NvbnRyb2xsZXInKSB7XHJcblx0XHRcdFx0dmFyIGRpcmVjdGlvblggPSAwO1xyXG5cdFx0XHRcdGlmICh0b3VjaEluc3RhbmNlLmhhc0NsYXNzKCdsZWZ0JykpIHtcclxuXHRcdFx0XHRcdGRpcmVjdGlvblggPSAtMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ3JpZ2h0JykpIHtcclxuXHRcdFx0XHRcdGRpcmVjdGlvblggPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgZGlyZWN0aW9uWSA9IDA7XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ3RvcCcpKSB7XHJcblx0XHRcdFx0XHRkaXJlY3Rpb25ZID0gLTFcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ2JvdHRvbScpKSB7XHJcblx0XHRcdFx0XHRkaXJlY3Rpb25ZID0gMVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgY2hhbmdlWCA9IGNoYW5nZVgxICogZGlyZWN0aW9uWDtcclxuXHRcdFx0XHR2YXIgY2hhbmdlWSA9IGNoYW5nZVkxICogZGlyZWN0aW9uWTtcclxuXHRcdFx0XHQvLyDmr5TkvovnvKnmlL7mjqfliLZcclxuXHRcdFx0XHRpZiAocmF0aW8gIT09IDApIHtcclxuXHRcdFx0XHRcdGlmIChkaXJlY3Rpb25YICogZGlyZWN0aW9uWSAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY2hhbmdlWCAvIHJhdGlvID4gY2hhbmdlWSkge1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVkgPSBjaGFuZ2VYIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0XHRjaGFuZ2VYID0gY2hhbmdlWSAqIHJhdGlvXHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Y2hhbmdlWCA9IGNoYW5nZVkgKiByYXRpb1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVkgPSBjaGFuZ2VYIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRpcmVjdGlvblggPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVggPSBjaGFuZ2VZICogcmF0aW9cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRjaGFuZ2VZID0gY2hhbmdlWCAvIHJhdGlvXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIHJlYWxTaXplID0gZ2V0UmVhbFNpemUoKVxyXG5cdFx0XHRcdHZhciB3aWR0aCA9IGNyb3BwZXJSZWN0LndpZHRoICsgY2hhbmdlWFxyXG5cdFx0XHRcdHZhciBoZWlnaHQgPSBjcm9wcGVyUmVjdC5oZWlnaHQgKyBjaGFuZ2VZXHJcblx0XHRcdFx0Ly8gdmFyIGltYWdlUmlnaHQgPSBpbWFnZVJlY3QubGVmdCArIGltYWdlUmVjdC53aWR0aFxyXG5cdFx0XHRcdC8vIHZhciBpbWFnZUJvdHRvbSA9IGltYWdlUmVjdC50b3AgKyBpbWFnZVJlY3QuaGVpZ2h0XHJcblx0XHRcdFx0dmFyIGltYWdlUmlnaHQgPSByZWFsU2l6ZS5sZWZ0K3JlYWxTaXplLndpZHRoXHJcblx0XHRcdFx0dmFyIGltYWdlQm90dG9tID0gcmVhbFNpemUudG9wK3JlYWxTaXplLmhlaWdodFxyXG5cdFx0XHRcdGlmIChkaXJlY3Rpb25YICE9IC0xKSB7XHJcblx0XHRcdFx0XHRpZiAoY3JvcHBlclJlY3QubGVmdCArIHdpZHRoID4gaW1hZ2VSaWdodCkge1xyXG5cdFx0XHRcdFx0XHR3aWR0aCA9IGltYWdlUmlnaHQgLSBjcm9wcGVyUmVjdC5sZWZ0XHJcblx0XHRcdFx0XHRcdGlmIChyYXRpbyAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGhlaWdodCA9IHdpZHRoIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR2YXIgY0xlZnQgPSBjcm9wcGVyUmVjdC5sZWZ0IC0gY2hhbmdlWFxyXG5cdFx0XHRcdFx0aWYgKGNMZWZ0IDwgcmVhbFNpemUubGVmdCkge1xyXG5cdFx0XHRcdFx0XHR3aWR0aCA9IGNyb3BwZXJSZWN0LmxlZnQgKyBjcm9wcGVyUmVjdC53aWR0aCAtIHJlYWxTaXplLmxlZnRcclxuXHRcdFx0XHRcdFx0aWYgKHJhdGlvICE9PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0aGVpZ2h0ID0gd2lkdGggLyByYXRpb1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIOWIpOaWreaYr%2BWQpuinpuW6lVxyXG5cdFx0XHRcdGlmIChkaXJlY3Rpb25ZICE9IC0xKSB7XHJcblx0XHRcdFx0XHRpZiAoY3JvcHBlclJlY3QudG9wICsgaGVpZ2h0ID4gaW1hZ2VCb3R0b20pIHtcclxuXHRcdFx0XHRcdFx0aGVpZ2h0ID0gaW1hZ2VCb3R0b20gLSBjcm9wcGVyUmVjdC50b3BcclxuXHRcdFx0XHRcdFx0aWYgKHJhdGlvICE9PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2lkdGggPSBoZWlnaHQgKiByYXRpb1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHZhciBjVG9wID0gY3JvcHBlclJlY3QudG9wIC0gY2hhbmdlWVxyXG5cdFx0XHRcdFx0aWYgKGNUb3AgPCByZWFsU2l6ZS50b3ApIHtcclxuXHRcdFx0XHRcdFx0aGVpZ2h0ID0gY3JvcHBlclJlY3QudG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0IC0gcmVhbFNpemUudG9wXHJcblx0XHRcdFx0XHRcdGlmIChyYXRpbyAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHdpZHRoID0gaGVpZ2h0ICogcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZGlyZWN0aW9uWCA9PSAtMSkge1xyXG5cdFx0XHRcdFx0Y2hhbmdlcy5jcm9wcGVyUmVjdC5sZWZ0ID0gY3JvcHBlclJlY3QubGVmdCArIGNyb3BwZXJSZWN0LndpZHRoIC0gd2lkdGhcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGRpcmVjdGlvblkgPT0gLTEpIHtcclxuXHRcdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QudG9wID0gY3JvcHBlclJlY3QudG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0IC0gaGVpZ2h0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIOi%2BueeVjOaOp%2BWItlxyXG5cdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3Qud2lkdGggPSB3aWR0aFxyXG5cdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QuaGVpZ2h0ID0gaGVpZ2h0XHJcblx0XHRcdFx0dXBkYXRlQ29wcGVyU3R5bGUoKVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKHRvdWNoZXMubGVuZ3RoID09IDIgJiYgc3RhcnRUb3VjaHMubGVuZ3RoID09IDIpIHtcclxuXHRcdFx0dmFyIGNoYW5nZVgyID0gdG91Y2hlc1swXS5jbGllbnRYIC0gdG91Y2hlc1sxXS5jbGllbnRYO1xyXG5cdFx0XHR2YXIgY2hhbmdlWTIgPSB0b3VjaGVzWzBdLmNsaWVudFkgLSB0b3VjaGVzWzFdLmNsaWVudFk7XHJcblx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucG93KGNoYW5nZVgyLCAyKSArIE1hdGgucG93KGNoYW5nZVkyLCAyKVxyXG5cdFx0XHRkaXN0YW5jZSA9IE1hdGguc3FydChkaXN0YW5jZSlcclxuXHRcdFx0Ly8g5pS%2B5aSn5q%2BU5L6LXHJcblx0XHRcdHZhciBzY2FsZVJhdGUgPSBkaXN0YW5jZSAvIHN0YXJ0RGlzdGFuY2VcclxuXHRcdFx0aW1hZ2VTY2FsZShzY2FsZVJhdGUpXHJcblx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0dG91Y2hFbmQ6IGZ1bmN0aW9uIChldiwgb2kpIHtcclxuXHRcdGlmICh0b3VjaFR5cGUgPT09IFwiaW1hZ2VcIikge1xyXG5cdFx0XHR2YXIgY3JvcHBlckxlZnQgPSBjcm9wcGVyUmVjdC5sZWZ0XHJcblx0XHRcdHZhciBjcm9wcGVyUmlnaHQgPSBjcm9wcGVyUmVjdC5sZWZ0ICsgY3JvcHBlclJlY3Qud2lkdGhcclxuXHRcdFx0dmFyIGNyb3BwZXJUb3AgPSBjcm9wcGVyUmVjdC50b3BcclxuXHRcdFx0dmFyIGNyb3BwZXJCb3R0b20gPSBjcm9wcGVyVG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0XHJcblx0XHRcdHZhciBjcm9wcGVyUmF0ZSA9IGNyb3BwZXJSZWN0LndpZHRoIC8gY3JvcHBlclJlY3QuaGVpZ2h0XHJcblx0XHRcdHZhciByZWFsU2l6ZSA9IGdldFJlYWxTaXplKClcclxuXHRcdFx0dmFyIHJhdGUgPSByZWFsU2l6ZS53aWR0aCAvIHJlYWxTaXplLmhlaWdodFxyXG5cdFx0XHRpZiAocmVhbFNpemUud2lkdGggPCBjcm9wcGVyUmVjdC53aWR0aCB8fCByZWFsU2l6ZS5oZWlnaHQgPCBjcm9wcGVyUmVjdC5oZWlnaHQpIHtcclxuXHRcdFx0XHR2YXIgc2NhbGUgPSAxXHJcblx0XHRcdFx0aWYgKHJhdGUgPCBjcm9wcGVyUmF0ZSkge1xyXG5cdFx0XHRcdFx0c2NhbGUgPSBjcm9wcGVyUmVjdC53aWR0aCAvIHJlYWxTaXplLndpZHRoXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHNjYWxlID0gY3JvcHBlclJlY3QuaGVpZ2h0IC8gcmVhbFNpemUuaGVpZ2h0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGltYWdlUmVjdC53aWR0aCA9IGNoYW5nZXMuaW1hZ2VSZWN0LndpZHRoXHJcblx0XHRcdFx0aW1hZ2VSZWN0LmhlaWdodCA9IGNoYW5nZXMuaW1hZ2VSZWN0LmhlaWdodFxyXG5cdFx0XHRcdGltYWdlU2NhbGUoc2NhbGUpXHJcblx0XHRcdH1cclxuXHRcdFx0Ly8g6L6555WM5o6n5Yi2c3RhcnRcclxuXHRcdFx0aWYgKGNyb3BwZXJMZWZ0IDwgcmVhbFNpemUubGVmdCkge1xyXG5cdFx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0LmxlZnQgPSBjcm9wcGVyTGVmdCArIHJlYWxTaXplLmR3LzJcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY3JvcHBlclJpZ2h0ID4gcmVhbFNpemUubGVmdCArIHJlYWxTaXplLndpZHRoKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QubGVmdCA9IGNyb3BwZXJSaWdodCAtIHJlYWxTaXplLndpZHRoICsgcmVhbFNpemUuZHcvMlxyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChjcm9wcGVyVG9wIDwgcmVhbFNpemUudG9wKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QudG9wID0gY3JvcHBlclRvcCArIHJlYWxTaXplLmRoLzJcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY3JvcHBlckJvdHRvbSA%2BIHJlYWxTaXplLnRvcCArIHJlYWxTaXplLmhlaWdodCkge1xyXG5cdFx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0LnRvcCA9IGNyb3BwZXJCb3R0b20gLSByZWFsU2l6ZS5oZWlnaHQgKyByZWFsU2l6ZS5kaC8yXHJcblx0XHRcdH1cclxuXHRcdFx0Ly8g6L6555WM5o6n5Yi2ZW5kXHJcblx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0fVxyXG5cdFx0b2kuY2FsbE1ldGhvZCgndXBkYXRlRGF0YScsIHtcclxuXHRcdFx0Y3JvcHBlclJlY3Q6IGNoYW5nZXMuY3JvcHBlclJlY3QsXHJcblx0XHRcdGltYWdlUmVjdDogY2hhbmdlcy5pbWFnZVJlY3QsXHJcblx0XHR9KVxyXG5cdFx0dG91Y2hUeXBlID0gXCJcIlxyXG5cdFx0c3RhcnRUb3VjaHMgPSBbXVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0Ly8g5bCG6YC76L6R5bGC55qE5Zu%2B5YOP5Y%2BY5o2i5ZCM5q2l6L%2BH5p2lXHJcblx0Ly8g6KOB5Ymq5q%2BU5L6L5Y%2BY5YyWXHJcblx0Y2hhbmdlUmF0aW86IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdFx0cmF0aW8gPSB2YWx1ZVxyXG5cdH0sXHJcblx0Y2hhbmdlUm90YXRlQW5nbGU6ZnVuY3Rpb24gKHZhbHVlKXtcclxuXHRcdHJvdGF0ZUFuZ2xlID0gdmFsdWU7XHJcblx0XHRpZihpbWFnZUluc3RhbmNlKXtcclxuXHRcdFx0dXBkYXRlSW1hZ2VTdHlsZSgpXHJcblx0XHR9XHJcblx0XHR2YXIgcmVhbFNpemUgPSBnZXRSZWFsU2l6ZSgpXHJcblx0fSxcclxuXHRjaGFuZ2VJbWFnZVJlY3Q6IGZ1bmN0aW9uICh2YWx1ZSwgb2xkVmFsdWUsIG9pKSB7XHJcblx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0aW1hZ2VSZWN0ID0gdmFsdWU7XHJcblx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0ID0ge1xyXG5cdFx0XHRcdGxlZnQ6IHZhbHVlLmxlZnQsXHJcblx0XHRcdFx0dG9wOiB2YWx1ZS50b3AsXHJcblx0XHRcdFx0d2lkdGg6IHZhbHVlLndpZHRoLFxyXG5cdFx0XHRcdGhlaWdodDogdmFsdWUuaGVpZ2h0XHJcblx0XHRcdH07XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cdFx0XHRpbWFnZUluc3RhbmNlID0gb2kuc2VsZWN0Q29tcG9uZW50KCcubWFpbkNvbnRlbnQgPiAuaW1hZ2UnKVxyXG5cdFx0XHR1cGRhdGVJbWFnZVN0eWxlKCk7XHJcblxyXG5cdFx0fVxyXG5cdH0sXHJcblx0Y2hhbmdlQ3JvcHBlcjogZnVuY3Rpb24gKHZhbHVlLCBvbGRWYWx1ZSwgb2kpIHtcclxuXHRcdGlmICh2YWx1ZSkge1xyXG5cdFx0XHRjcm9wcGVyUmVjdCA9IHZhbHVlXHJcblx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QgPSB7XHJcblx0XHRcdFx0bGVmdDogdmFsdWUubGVmdCxcclxuXHRcdFx0XHR0b3A6IHZhbHVlLnRvcCxcclxuXHRcdFx0XHR3aWR0aDogdmFsdWUud2lkdGgsXHJcblx0XHRcdFx0aGVpZ2h0OiB2YWx1ZS5oZWlnaHRcclxuXHRcdFx0fVxyXG5cclxuXHJcblxyXG5cdFx0XHRcdGNyb3BwZXJJbnN0YW5jZSA9IG9pLnNlbGVjdENvbXBvbmVudCgnLm1haW5Db250ZW50ID4gLmNyb3BwZXInKVxyXG5cdFx0XHRcdHVwZGF0ZUNvcHBlclN0eWxlKClcclxuXHJcblxyXG5cclxuXHRcdH1cclxuXHR9XHJcbn0iLCJzdGFydCI6MTc3MjgsImF0dHJzIjp7Im1vZHVsZSI6Ind4c01vZHVsZSIsImxhbmciOiJ3eHMifSwiZW5kIjoyNjc2OH19&\"\nvar renderjs\nimport script from \"./bt-cropper.vue?vue&type=script&lang=js&\"\nexport * from \"./bt-cropper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bt-cropper.vue?vue&type=style&index=0&id=db75b244&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"db75b244\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\n/* custom blocks */\nimport block0 from \"./bt-cropper.vue?vue&type=custom&index=0&blockType=script&module=wxsModule&lang=wxs\"\nif (typeof block0 === 'function') block0(component)\n\ncomponent.options.__file = \"uni_modules/bt-cropper/components/bt-cropper/bt-cropper.vue\"\nexport default component.exports","export * from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=template&id=db75b244&scoped=true&filter-modules=eyJ3eHNNb2R1bGUiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiJ2YXIgc3RhcnRUb3VjaHMgPSBbXTtcclxudmFyIHN0YXJ0RGlzdGFuY2UgPSAwO1xyXG52YXIgdG91Y2hDZW50ZXIgPSBbXTtcclxudmFyIHJhdGlvID0gMDtcclxudmFyIGltYWdlSW5zdGFuY2UgPSBudWxsO1xyXG52YXIgY3JvcHBlckluc3RhbmNlID0gbnVsbDtcclxudmFyIHRvdWNoVHlwZSA9IFwiXCI7XHJcbnZhciB0b3VjaEluc3RhbmNlID0gbnVsbDtcclxudmFyIGNyb3BwZXJSZWN0ID0gbnVsbDtcclxudmFyIGltYWdlUmVjdCA9IG51bGw7XHJcbi8vIOaXi%2Bi9rOinkuW6plxyXG52YXIgcm90YXRlQW5nbGUgPSAwO1xyXG4vLyDmk43kvZzml7bmlLnlj5jnmoTlr7nosaFcclxudmFyIGNoYW5nZXMgPSB7XHJcblx0aW1hZ2VSZWN0OiBudWxsLFxyXG5cdGNyb3BwZXJSZWN0OiBudWxsXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUltYWdlU3R5bGUoKSB7XHJcblx0dmFyIGltYWdlUmVjdCA9IGNoYW5nZXMuaW1hZ2VSZWN0XHJcblx0aW1hZ2VJbnN0YW5jZS5zZXRTdHlsZSh7XHJcblx0XHRsZWZ0OiBpbWFnZVJlY3QubGVmdCArICdweCcsXHJcblx0XHR0b3A6IGltYWdlUmVjdC50b3AgKyAncHgnLFxyXG5cdFx0d2lkdGg6IGltYWdlUmVjdC53aWR0aCArICdweCcsXHJcblx0XHRoZWlnaHQ6IGltYWdlUmVjdC5oZWlnaHQgKyAncHgnLFxyXG5cdFx0dHJhbnNmb3JtOiAncm90YXRlKCcgKyByb3RhdGVBbmdsZSArICdkZWcpJ1xyXG5cdH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUNvcHBlclN0eWxlKCkge1xyXG5cdHZhciBjcm9wcGVyUmVjdCA9IGNoYW5nZXMuY3JvcHBlclJlY3RcclxuXHRjcm9wcGVySW5zdGFuY2Uuc2V0U3R5bGUoe1xyXG5cdFx0bGVmdDogY3JvcHBlclJlY3QubGVmdCArIFwicHhcIixcclxuXHRcdHRvcDogY3JvcHBlclJlY3QudG9wICsgXCJweFwiLFxyXG5cdFx0d2lkdGg6IGNyb3BwZXJSZWN0LndpZHRoICsgXCJweFwiLFxyXG5cdFx0aGVpZ2h0OiBjcm9wcGVyUmVjdC5oZWlnaHQgKyBcInB4XCJcclxuXHR9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbWFnZVNjYWxlKHNjYWxlUmF0ZSkge1xyXG5cdHZhciBjdyA9IGltYWdlUmVjdC53aWR0aCAqIChzY2FsZVJhdGUgLSAxKVxyXG5cdHZhciBjaCA9IGltYWdlUmVjdC5oZWlnaHQgKiAoc2NhbGVSYXRlIC0gMSlcclxuXHRjaGFuZ2VzLmltYWdlUmVjdCA9IHtcclxuXHRcdHdpZHRoOiBpbWFnZVJlY3Qud2lkdGggKyBjdyxcclxuXHRcdGhlaWdodDogaW1hZ2VSZWN0LmhlaWdodCArIGNoLFxyXG5cdFx0bGVmdDogaW1hZ2VSZWN0LmxlZnQgLSBjdyAqICh0b3VjaENlbnRlclswXSksXHJcblx0XHR0b3A6IGltYWdlUmVjdC50b3AgLSBjaCAqICh0b3VjaENlbnRlclsxXSlcclxuXHR9XHJcbn1cclxuZnVuY3Rpb24gZ2V0SW1hZ2VSb3RhdGVTaXplQ2hhbmdlKHcsaCl7XHJcblx0dmFyIGN3ID0gaCpNYXRoLnNpbihyb3RhdGVBbmdsZS8xODAgKiBNYXRoLlBJKVxyXG5cdHZhciBjaCA9IHcqTWF0aC5zaW4ocm90YXRlQW5nbGUvMTgwICogTWF0aC5QSSlcclxuXHRyZXR1cm4ge2N3LGNofVxyXG59XHJcbi8vIOinkuW6pui9rOW8p%2BW6plxyXG5mdW5jdGlvbiBhbmcyZGVnKGFuZyl7XHJcblx0cmV0dXJuIGFuZy8xODAqTWF0aC5QSVxyXG59XHJcbi8vIOiuoeeul%2BaXi%2Bi9rOWQjuecn%2BWunueahOWbvueJh%2BWkp%2BWwj1xyXG5mdW5jdGlvbiBnZXRSZWFsU2l6ZSgpe1xyXG5cdHZhciB3ID0gY2hhbmdlcy5pbWFnZVJlY3Qud2lkdGhcclxuXHR2YXIgaCA9IGNoYW5nZXMuaW1hZ2VSZWN0LmhlaWdodFxyXG5cdHZhciBsID0gIGNoYW5nZXMuaW1hZ2VSZWN0LmxlZnRcclxuXHR2YXIgdCA9ICBjaGFuZ2VzLmltYWdlUmVjdC50b3BcclxuXHQvLyDlhoXmlpzovrlcclxuXHR2YXIgUiA9IE1hdGguc3FydCh3KncraCpoKVxyXG5cdHZhciBhbmdsZSA9IE1hdGguYXRhbihoL3cpIC8gTWF0aC5QSSAqIDE4MFxyXG5cdHZhciByb3JhdGUgPSByb3RhdGVBbmdsZSU5MFxyXG5cdHZhciBkaXJlY3QgPSBNYXRoLmZsb29yKHJvdGF0ZUFuZ2xlLzkwKVxyXG5cdHZhciB3aWR0aCA9IFIqTWF0aC5jb3MoYW5nMmRlZyhhbmdsZS1yb3JhdGUpKVxyXG5cdHZhciBoZWlnaHQgPSBSKk1hdGguc2luKGFuZzJkZWcoYW5nbGUrcm9yYXRlKSlcclxuXHRpZihkaXJlY3QgJSAyID09PSAxKXtcclxuXHRcdHZhciB0ZW1wID0gd2lkdGhcclxuXHRcdHdpZHRoID0gaGVpZ2h0XHJcblx0XHRoZWlnaHQgPSB0ZW1wXHJcblx0fVxyXG5cdHJldHVybiB7XHJcblx0XHR3aWR0aDogd2lkdGgsXHJcblx0XHRoZWlnaHQ6IGhlaWdodCxcclxuXHRcdGxlZnQ6IGwgLSAod2lkdGggLSB3KS8yLFxyXG5cdFx0dG9wOiB0IC0gKGhlaWdodCAtIGgpLzIsXHJcblx0XHRkdzogd2lkdGggLSB3LFxyXG5cdFx0ZGg6IGhlaWdodCAtIGhcclxuXHR9XHJcbn1cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcblx0dG91Y2hTdGFydDogZnVuY3Rpb24gKGV2LCBvaSkge1xyXG5cclxuXHJcblxyXG5cclxuXHRcdHRvdWNoSW5zdGFuY2UgPSBldi5pbnN0YW5jZTtcclxuXHRcdHZhciBkYXRhU2V0ID0gZXYuaW5zdGFuY2UuZ2V0RGF0YXNldCgpXHJcblx0XHR0b3VjaFR5cGUgPSBkYXRhU2V0LnR5cGU7XHJcblx0XHRzdGFydFRvdWNocyA9IGV2LnRvdWNoZXM7XHJcblx0XHRvaS5jYWxsTWV0aG9kKCdvblRvdWNoU3RhcnQnKVxyXG5cdFx0aWYgKHN0YXJ0VG91Y2hzLmxlbmd0aCA9PSAyKSB7XHJcblx0XHRcdHRvdWNoVHlwZSA9IFwiaW1hZ2VcIlxyXG5cdFx0XHR2YXIgeDEgPSBzdGFydFRvdWNoc1swXS5jbGllbnRYXHJcblx0XHRcdHZhciB5MSA9IHN0YXJ0VG91Y2hzWzBdLmNsaWVudFlcclxuXHRcdFx0dmFyIHgyID0gc3RhcnRUb3VjaHNbMV0uY2xpZW50WFxyXG5cdFx0XHR2YXIgeTIgPSBzdGFydFRvdWNoc1sxXS5jbGllbnRZXHJcblx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucG93KHgyIC0geDEsIDIpICsgTWF0aC5wb3coeTIgLSB5MSwgMilcclxuXHRcdFx0c3RhcnREaXN0YW5jZSA9IE1hdGguc3FydChkaXN0YW5jZSlcclxuXHRcdFx0dmFyIGxlZnRQZXJjZW50ID0gKCh4MSArIHgyKSAvIDIgLSBpbWFnZVJlY3QubGVmdCkgLyBpbWFnZVJlY3Qud2lkdGhcclxuXHRcdFx0dmFyIHRvcFBlcmNlbnQgPSAoKHkxICsgeTIpIC8gMiAtIGltYWdlUmVjdC50b3ApIC8gaW1hZ2VSZWN0LmhlaWdodFxyXG5cdFx0XHR0b3VjaENlbnRlciA9IFtsZWZ0UGVyY2VudCwgdG9wUGVyY2VudF1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9LFxyXG5cdHRvdWNoTW92ZTogZnVuY3Rpb24gKGV2LCBpbykge1xyXG5cdFx0aWYgKHRvdWNoVHlwZSA9PSBcIlwiKSByZXR1cm4gZmFsc2VcclxuXHJcblxyXG5cclxuXHJcblx0XHR2YXIgdG91Y2hlcyA9IGV2LnRvdWNoZXM7XHJcblx0XHR2YXIgY2hhbmdlWDEgPSB0b3VjaGVzWzBdLmNsaWVudFggLSBzdGFydFRvdWNoc1swXS5jbGllbnRYO1xyXG5cdFx0dmFyIGNoYW5nZVkxID0gdG91Y2hlc1swXS5jbGllbnRZIC0gc3RhcnRUb3VjaHNbMF0uY2xpZW50WTtcclxuXHRcdGlmIChzdGFydFRvdWNocy5sZW5ndGggPT0gMSkge1xyXG5cdFx0XHRpZiAodG91Y2hUeXBlID09PSAnaW1hZ2UnKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QubGVmdCA9IGltYWdlUmVjdC5sZWZ0ICsgY2hhbmdlWDE7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QudG9wID0gaW1hZ2VSZWN0LnRvcCArIGNoYW5nZVkxO1xyXG5cdFx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0XHR9IGVsc2UgaWYgKHRvdWNoVHlwZSA9PT0gJ2NvbnRyb2xsZXInKSB7XHJcblx0XHRcdFx0dmFyIGRpcmVjdGlvblggPSAwO1xyXG5cdFx0XHRcdGlmICh0b3VjaEluc3RhbmNlLmhhc0NsYXNzKCdsZWZ0JykpIHtcclxuXHRcdFx0XHRcdGRpcmVjdGlvblggPSAtMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ3JpZ2h0JykpIHtcclxuXHRcdFx0XHRcdGRpcmVjdGlvblggPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgZGlyZWN0aW9uWSA9IDA7XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ3RvcCcpKSB7XHJcblx0XHRcdFx0XHRkaXJlY3Rpb25ZID0gLTFcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRvdWNoSW5zdGFuY2UuaGFzQ2xhc3MoJ2JvdHRvbScpKSB7XHJcblx0XHRcdFx0XHRkaXJlY3Rpb25ZID0gMVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgY2hhbmdlWCA9IGNoYW5nZVgxICogZGlyZWN0aW9uWDtcclxuXHRcdFx0XHR2YXIgY2hhbmdlWSA9IGNoYW5nZVkxICogZGlyZWN0aW9uWTtcclxuXHRcdFx0XHQvLyDmr5TkvovnvKnmlL7mjqfliLZcclxuXHRcdFx0XHRpZiAocmF0aW8gIT09IDApIHtcclxuXHRcdFx0XHRcdGlmIChkaXJlY3Rpb25YICogZGlyZWN0aW9uWSAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY2hhbmdlWCAvIHJhdGlvID4gY2hhbmdlWSkge1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVkgPSBjaGFuZ2VYIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0XHRjaGFuZ2VYID0gY2hhbmdlWSAqIHJhdGlvXHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Y2hhbmdlWCA9IGNoYW5nZVkgKiByYXRpb1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVkgPSBjaGFuZ2VYIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0aWYgKGRpcmVjdGlvblggPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGNoYW5nZVggPSBjaGFuZ2VZICogcmF0aW9cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRjaGFuZ2VZID0gY2hhbmdlWCAvIHJhdGlvXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIHJlYWxTaXplID0gZ2V0UmVhbFNpemUoKVxyXG5cdFx0XHRcdHZhciB3aWR0aCA9IGNyb3BwZXJSZWN0LndpZHRoICsgY2hhbmdlWFxyXG5cdFx0XHRcdHZhciBoZWlnaHQgPSBjcm9wcGVyUmVjdC5oZWlnaHQgKyBjaGFuZ2VZXHJcblx0XHRcdFx0Ly8gdmFyIGltYWdlUmlnaHQgPSBpbWFnZVJlY3QubGVmdCArIGltYWdlUmVjdC53aWR0aFxyXG5cdFx0XHRcdC8vIHZhciBpbWFnZUJvdHRvbSA9IGltYWdlUmVjdC50b3AgKyBpbWFnZVJlY3QuaGVpZ2h0XHJcblx0XHRcdFx0dmFyIGltYWdlUmlnaHQgPSByZWFsU2l6ZS5sZWZ0K3JlYWxTaXplLndpZHRoXHJcblx0XHRcdFx0dmFyIGltYWdlQm90dG9tID0gcmVhbFNpemUudG9wK3JlYWxTaXplLmhlaWdodFxyXG5cdFx0XHRcdGlmIChkaXJlY3Rpb25YICE9IC0xKSB7XHJcblx0XHRcdFx0XHRpZiAoY3JvcHBlclJlY3QubGVmdCArIHdpZHRoID4gaW1hZ2VSaWdodCkge1xyXG5cdFx0XHRcdFx0XHR3aWR0aCA9IGltYWdlUmlnaHQgLSBjcm9wcGVyUmVjdC5sZWZ0XHJcblx0XHRcdFx0XHRcdGlmIChyYXRpbyAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGhlaWdodCA9IHdpZHRoIC8gcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHR2YXIgY0xlZnQgPSBjcm9wcGVyUmVjdC5sZWZ0IC0gY2hhbmdlWFxyXG5cdFx0XHRcdFx0aWYgKGNMZWZ0IDwgcmVhbFNpemUubGVmdCkge1xyXG5cdFx0XHRcdFx0XHR3aWR0aCA9IGNyb3BwZXJSZWN0LmxlZnQgKyBjcm9wcGVyUmVjdC53aWR0aCAtIHJlYWxTaXplLmxlZnRcclxuXHRcdFx0XHRcdFx0aWYgKHJhdGlvICE9PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0aGVpZ2h0ID0gd2lkdGggLyByYXRpb1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIOWIpOaWreaYr%2BWQpuinpuW6lVxyXG5cdFx0XHRcdGlmIChkaXJlY3Rpb25ZICE9IC0xKSB7XHJcblx0XHRcdFx0XHRpZiAoY3JvcHBlclJlY3QudG9wICsgaGVpZ2h0ID4gaW1hZ2VCb3R0b20pIHtcclxuXHRcdFx0XHRcdFx0aGVpZ2h0ID0gaW1hZ2VCb3R0b20gLSBjcm9wcGVyUmVjdC50b3BcclxuXHRcdFx0XHRcdFx0aWYgKHJhdGlvICE9PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0d2lkdGggPSBoZWlnaHQgKiByYXRpb1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHZhciBjVG9wID0gY3JvcHBlclJlY3QudG9wIC0gY2hhbmdlWVxyXG5cdFx0XHRcdFx0aWYgKGNUb3AgPCByZWFsU2l6ZS50b3ApIHtcclxuXHRcdFx0XHRcdFx0aGVpZ2h0ID0gY3JvcHBlclJlY3QudG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0IC0gcmVhbFNpemUudG9wXHJcblx0XHRcdFx0XHRcdGlmIChyYXRpbyAhPT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHdpZHRoID0gaGVpZ2h0ICogcmF0aW9cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZGlyZWN0aW9uWCA9PSAtMSkge1xyXG5cdFx0XHRcdFx0Y2hhbmdlcy5jcm9wcGVyUmVjdC5sZWZ0ID0gY3JvcHBlclJlY3QubGVmdCArIGNyb3BwZXJSZWN0LndpZHRoIC0gd2lkdGhcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGRpcmVjdGlvblkgPT0gLTEpIHtcclxuXHRcdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QudG9wID0gY3JvcHBlclJlY3QudG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0IC0gaGVpZ2h0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIOi%2BueeVjOaOp%2BWItlxyXG5cdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3Qud2lkdGggPSB3aWR0aFxyXG5cdFx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QuaGVpZ2h0ID0gaGVpZ2h0XHJcblx0XHRcdFx0dXBkYXRlQ29wcGVyU3R5bGUoKVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKHRvdWNoZXMubGVuZ3RoID09IDIgJiYgc3RhcnRUb3VjaHMubGVuZ3RoID09IDIpIHtcclxuXHRcdFx0dmFyIGNoYW5nZVgyID0gdG91Y2hlc1swXS5jbGllbnRYIC0gdG91Y2hlc1sxXS5jbGllbnRYO1xyXG5cdFx0XHR2YXIgY2hhbmdlWTIgPSB0b3VjaGVzWzBdLmNsaWVudFkgLSB0b3VjaGVzWzFdLmNsaWVudFk7XHJcblx0XHRcdHZhciBkaXN0YW5jZSA9IE1hdGgucG93KGNoYW5nZVgyLCAyKSArIE1hdGgucG93KGNoYW5nZVkyLCAyKVxyXG5cdFx0XHRkaXN0YW5jZSA9IE1hdGguc3FydChkaXN0YW5jZSlcclxuXHRcdFx0Ly8g5pS%2B5aSn5q%2BU5L6LXHJcblx0XHRcdHZhciBzY2FsZVJhdGUgPSBkaXN0YW5jZSAvIHN0YXJ0RGlzdGFuY2VcclxuXHRcdFx0aW1hZ2VTY2FsZShzY2FsZVJhdGUpXHJcblx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0dG91Y2hFbmQ6IGZ1bmN0aW9uIChldiwgb2kpIHtcclxuXHRcdGlmICh0b3VjaFR5cGUgPT09IFwiaW1hZ2VcIikge1xyXG5cdFx0XHR2YXIgY3JvcHBlckxlZnQgPSBjcm9wcGVyUmVjdC5sZWZ0XHJcblx0XHRcdHZhciBjcm9wcGVyUmlnaHQgPSBjcm9wcGVyUmVjdC5sZWZ0ICsgY3JvcHBlclJlY3Qud2lkdGhcclxuXHRcdFx0dmFyIGNyb3BwZXJUb3AgPSBjcm9wcGVyUmVjdC50b3BcclxuXHRcdFx0dmFyIGNyb3BwZXJCb3R0b20gPSBjcm9wcGVyVG9wICsgY3JvcHBlclJlY3QuaGVpZ2h0XHJcblx0XHRcdHZhciBjcm9wcGVyUmF0ZSA9IGNyb3BwZXJSZWN0LndpZHRoIC8gY3JvcHBlclJlY3QuaGVpZ2h0XHJcblx0XHRcdHZhciByZWFsU2l6ZSA9IGdldFJlYWxTaXplKClcclxuXHRcdFx0dmFyIHJhdGUgPSByZWFsU2l6ZS53aWR0aCAvIHJlYWxTaXplLmhlaWdodFxyXG5cdFx0XHRpZiAocmVhbFNpemUud2lkdGggPCBjcm9wcGVyUmVjdC53aWR0aCB8fCByZWFsU2l6ZS5oZWlnaHQgPCBjcm9wcGVyUmVjdC5oZWlnaHQpIHtcclxuXHRcdFx0XHR2YXIgc2NhbGUgPSAxXHJcblx0XHRcdFx0aWYgKHJhdGUgPCBjcm9wcGVyUmF0ZSkge1xyXG5cdFx0XHRcdFx0c2NhbGUgPSBjcm9wcGVyUmVjdC53aWR0aCAvIHJlYWxTaXplLndpZHRoXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHNjYWxlID0gY3JvcHBlclJlY3QuaGVpZ2h0IC8gcmVhbFNpemUuaGVpZ2h0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGltYWdlUmVjdC53aWR0aCA9IGNoYW5nZXMuaW1hZ2VSZWN0LndpZHRoXHJcblx0XHRcdFx0aW1hZ2VSZWN0LmhlaWdodCA9IGNoYW5nZXMuaW1hZ2VSZWN0LmhlaWdodFxyXG5cdFx0XHRcdGltYWdlU2NhbGUoc2NhbGUpXHJcblx0XHRcdH1cclxuXHRcdFx0Ly8g6L6555WM5o6n5Yi2c3RhcnRcclxuXHRcdFx0aWYgKGNyb3BwZXJMZWZ0IDwgcmVhbFNpemUubGVmdCkge1xyXG5cdFx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0LmxlZnQgPSBjcm9wcGVyTGVmdCArIHJlYWxTaXplLmR3LzJcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY3JvcHBlclJpZ2h0ID4gcmVhbFNpemUubGVmdCArIHJlYWxTaXplLndpZHRoKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QubGVmdCA9IGNyb3BwZXJSaWdodCAtIHJlYWxTaXplLndpZHRoICsgcmVhbFNpemUuZHcvMlxyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChjcm9wcGVyVG9wIDwgcmVhbFNpemUudG9wKSB7XHJcblx0XHRcdFx0Y2hhbmdlcy5pbWFnZVJlY3QudG9wID0gY3JvcHBlclRvcCArIHJlYWxTaXplLmRoLzJcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoY3JvcHBlckJvdHRvbSA%2BIHJlYWxTaXplLnRvcCArIHJlYWxTaXplLmhlaWdodCkge1xyXG5cdFx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0LnRvcCA9IGNyb3BwZXJCb3R0b20gLSByZWFsU2l6ZS5oZWlnaHQgKyByZWFsU2l6ZS5kaC8yXHJcblx0XHRcdH1cclxuXHRcdFx0Ly8g6L6555WM5o6n5Yi2ZW5kXHJcblx0XHRcdHVwZGF0ZUltYWdlU3R5bGUoKVxyXG5cdFx0fVxyXG5cdFx0b2kuY2FsbE1ldGhvZCgndXBkYXRlRGF0YScsIHtcclxuXHRcdFx0Y3JvcHBlclJlY3Q6IGNoYW5nZXMuY3JvcHBlclJlY3QsXHJcblx0XHRcdGltYWdlUmVjdDogY2hhbmdlcy5pbWFnZVJlY3QsXHJcblx0XHR9KVxyXG5cdFx0dG91Y2hUeXBlID0gXCJcIlxyXG5cdFx0c3RhcnRUb3VjaHMgPSBbXVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH0sXHJcblx0Ly8g5bCG6YC76L6R5bGC55qE5Zu%2B5YOP5Y%2BY5o2i5ZCM5q2l6L%2BH5p2lXHJcblx0Ly8g6KOB5Ymq5q%2BU5L6L5Y%2BY5YyWXHJcblx0Y2hhbmdlUmF0aW86IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdFx0cmF0aW8gPSB2YWx1ZVxyXG5cdH0sXHJcblx0Y2hhbmdlUm90YXRlQW5nbGU6ZnVuY3Rpb24gKHZhbHVlKXtcclxuXHRcdHJvdGF0ZUFuZ2xlID0gdmFsdWU7XHJcblx0XHRpZihpbWFnZUluc3RhbmNlKXtcclxuXHRcdFx0dXBkYXRlSW1hZ2VTdHlsZSgpXHJcblx0XHR9XHJcblx0XHR2YXIgcmVhbFNpemUgPSBnZXRSZWFsU2l6ZSgpXHJcblx0fSxcclxuXHRjaGFuZ2VJbWFnZVJlY3Q6IGZ1bmN0aW9uICh2YWx1ZSwgb2xkVmFsdWUsIG9pKSB7XHJcblx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0aW1hZ2VSZWN0ID0gdmFsdWU7XHJcblx0XHRcdGNoYW5nZXMuaW1hZ2VSZWN0ID0ge1xyXG5cdFx0XHRcdGxlZnQ6IHZhbHVlLmxlZnQsXHJcblx0XHRcdFx0dG9wOiB2YWx1ZS50b3AsXHJcblx0XHRcdFx0d2lkdGg6IHZhbHVlLndpZHRoLFxyXG5cdFx0XHRcdGhlaWdodDogdmFsdWUuaGVpZ2h0XHJcblx0XHRcdH07XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cdFx0XHRpbWFnZUluc3RhbmNlID0gb2kuc2VsZWN0Q29tcG9uZW50KCcubWFpbkNvbnRlbnQgPiAuaW1hZ2UnKVxyXG5cdFx0XHR1cGRhdGVJbWFnZVN0eWxlKCk7XHJcblxyXG5cdFx0fVxyXG5cdH0sXHJcblx0Y2hhbmdlQ3JvcHBlcjogZnVuY3Rpb24gKHZhbHVlLCBvbGRWYWx1ZSwgb2kpIHtcclxuXHRcdGlmICh2YWx1ZSkge1xyXG5cdFx0XHRjcm9wcGVyUmVjdCA9IHZhbHVlXHJcblx0XHRcdGNoYW5nZXMuY3JvcHBlclJlY3QgPSB7XHJcblx0XHRcdFx0bGVmdDogdmFsdWUubGVmdCxcclxuXHRcdFx0XHR0b3A6IHZhbHVlLnRvcCxcclxuXHRcdFx0XHR3aWR0aDogdmFsdWUud2lkdGgsXHJcblx0XHRcdFx0aGVpZ2h0OiB2YWx1ZS5oZWlnaHRcclxuXHRcdFx0fVxyXG5cclxuXHJcblxyXG5cdFx0XHRcdGNyb3BwZXJJbnN0YW5jZSA9IG9pLnNlbGVjdENvbXBvbmVudCgnLm1haW5Db250ZW50ID4gLmNyb3BwZXInKVxyXG5cdFx0XHRcdHVwZGF0ZUNvcHBlclN0eWxlKClcclxuXHJcblxyXG5cclxuXHRcdH1cclxuXHR9XHJcbn0iLCJzdGFydCI6MTc3MjgsImF0dHJzIjp7Im1vZHVsZSI6Ind4c01vZHVsZSIsImxhbmciOiJ3eHMifSwiZW5kIjoyNjc2OH19&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var s0 = _vm.__get_style([_vm.containerStyle])\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        s0: s0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"bt-container\" :style=\"[containerStyle]\">\r\n\t\t<!-- #ifdef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t<view class=\"mainContent\" data-type=\"image\" @touchstart=\"wxsModule.touchStart\" @touchmove=\"wxsModule.touchMove\" @touchend=\"wxsModule.touchEnd\">\r\n\t\t<!-- #endif -->\r\n\t\t<!-- #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t<view class=\"mainContent\" data-type=\"image\" @touchstart=\"touchStart\" @touchmove=\"touchMove\" @touchend=\"touchEnd\">\r\n\t\t<!-- #endif -->\r\n\t\t\t<template v-if=\"imageRect && cropperRect\">\r\n\t\t\t\t<!-- #ifdef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t\t\t<image mode=\"aspectFit\" :src=\"imageSrc\" class=\"image\" :rotateAngle=\"rotateAngle\" :change:rotateAngle=\"wxsModule.changeRotateAngle\" :change:imageRect=\"wxsModule.changeImageRect\" :imageRect=\"imageRect\" :class=\"{ anim }\">\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t<!-- #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t\t\t<image mode=\"aspectFit\" :src=\"imageSrc\" class=\"image\" :style=\"[imageStyle]\" :class=\"{ anim }\">\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t</image>\r\n\t\t\t\t<!-- #ifdef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t\t\t<view class=\"cropper\" :class=\"{ anim }\" :change:cropperRect=\"wxsModule.changeCropper\" :cropperRect=\"cropperRect\" :change:ratio=\"wxsModule.changeRatio\" :ratio=\"ratio\" >\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t<!-- #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n\t\t\t\t<view class=\"cropper\" :class=\"{ anim }\"  :style=\"[cropperStyle]\">\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t\t<image class=\"mask\" :src=\"mask\"></image>\r\n\t\t\t\t\t<template v-if=\"showGrid\">\r\n\t\t\t\t\t\t<view class=\"line row row1\"></view>\r\n\t\t\t\t\t\t<view class=\"line row row2\"></view>\r\n\t\t\t\t\t\t<view class=\"line col col1\"></view>\r\n\t\t\t\t\t\t<view class=\"line col col2\"></view>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<!-- #ifdef APP-VUE || MP-WEIXIN || MP-QQ || H5  -->\r\n\t\t\t\t\t<view class=\"controller vertical left\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller vertical right\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller horizon top\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller horizon bottom\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller left top\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller left bottom\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller right top\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<view class=\"controller right bottom\" @touchstart=\"wxsModule.touchStart\" data-type=\"controller\" />\r\n\t\t\t\t\t<!-- #endif -->\r\n\t\t\t\t\t<!-- #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5  -->\r\n\t\t\t\t\t<view class=\"controller vertical left\" @touchstart.stop=\"touchStart(-1, 0, $event)\" />\r\n\t\t\t\t\t<view class=\"controller vertical right\" @touchstart.stop=\"touchStart(1, 0, $event)\" />\r\n\t\t\t\t\t<view class=\"controller horizon top\" @touchstart.stop=\"touchStart(0, -1, $event)\" />\r\n\t\t\t\t\t<view class=\"controller horizon bottom\" @touchstart.stop=\"touchStart(0, 1, $event)\" />\r\n\t\t\t\t\t<view class=\"controller left top\" @touchstart.stop=\"touchStart(-1, -1, $event)\" />\r\n\t\t\t\t\t<view class=\"controller left bottom\" @touchstart.stop=\"touchStart(-1, 1, $event)\" />\r\n\t\t\t\t\t<view class=\"controller right top\" @touchstart.stop=\"touchStart(1, -1, $event)\" />\r\n\t\t\t\t\t<view class=\"controller right bottom\" @touchstart.stop=\"touchStart(1, 1, $event)\" />\r\n\t\t\t\t\t<!-- #endif -->\r\n\t\t\t\t</view>\r\n\t\t\t</template>\r\n\t\t</view>\r\n\t\t\t<canvas v-if=\"type2d\" type=\"2d\" class=\"bt-canvas\" :width=\"target.width\" :height=\"target.height\"></canvas>\r\n\t\t\t<canvas\r\n\t\t\t\tv-else\r\n\t\t\t\t:canvas-id=\"canvasId\"\r\n\t\t\t\tclass=\"bt-canvas\"\r\n\t\t\t\t:style=\"{\r\n\t\t\t\t\twidth: target.width + 'px',\r\n\t\t\t\t\theight: target.height + 'px'\r\n\t\t\t\t}\"\r\n\t\t\t\t:width=\"target.width * pixel\"\r\n\t\t\t\t:height=\"target.height * pixel\"\r\n\t\t\t></canvas>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n// #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5\r\nimport touches from './js/touchs.js';\r\n// #endif\r\nimport { parseUnit,sleep } from './utils/tools.js';\r\n/**\r\n * better-cropper 图片裁切插件\r\n */\r\nexport default {\r\n\tname: 'bt-cropper',\r\n\tprops: {\r\n\t\t// 图片路径，支持网络路径和本地路径\r\n\t\timageSrc: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '',\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tmask: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\t// 手动指定容器的大小\r\n\t\tcontainerSize: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\t// 输出图片的格式，默认jpg\r\n\t\tfileType: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'png'\r\n\t\t},\r\n\t\t// 生成的图片的宽度,不传或者传0表示按照原始分辨率裁切\r\n\t\tdWidth: Number,\r\n\t\tmaxWidth: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 2000\r\n\t\t},\r\n\t\t// 裁切比例，0表示自由\r\n\t\tratio: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 0,\r\n\t\t\tvalidator(value) {\r\n\t\t\t\tif (typeof value === 'number') {\r\n\t\t\t\t\tif (value < 0) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 旋转角度\r\n\t\trotate: Number,\r\n\t\t// 是否展示网格\r\n\t\tshowGrid: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t// 图片质量，0-1 越大质量越好\r\n\t\tquality: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 1\r\n\t\t},\r\n\t\tcanvas2d: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\t// 初始的图片位置\r\n\t\tinitPosition: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault() {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 是否开启操作结束后自动放大\r\n\t\tautoZoom: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: true\r\n\t\t}\r\n\t},\r\n\t// #ifndef APP-VUE || MP-WEIXIN || MP-QQ || H5\r\n\tmixins: [touches],\r\n\t// #endif\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcanvasId: 'bt-cropper',\r\n\t\t\tcontainerRect: null,\r\n\t\t\timageInfo: null,\r\n\t\t\toperationHistory: [],\r\n\t\t\toperationIndex: 0,\r\n\t\t\tanim: false,\r\n\t\t\ttimer: null,\r\n\t\t\t// 是否使用2D canvas\r\n\t\t\ttype2d: false,\r\n\t\t\tpixel: 1,\r\n\t\t\timageRect: null,\r\n\t\t\tcropperRect: null,\r\n\t\t\ttarget:{\r\n\t\t\t\twidth:0,\r\n\t\t\t\theight:0\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\timageSrc: {\r\n\t\t\thandler(src) {\r\n\t\t\t\tif (typeof src === 'string' && src !== '') {\r\n\t\t\t\t\tthis.imageInit(src);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.imageInfo = null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\timmediate: true\r\n\t\t},\r\n\t\tratio() {\r\n\t\t\tif (this.ratio != 0) {\r\n\t\t\t\tthis.startAnim();\r\n\t\t\t\tthis.init();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\tcontainerStyle() {\r\n\t\t\tif (this.containerSize && this.containerRect) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: this.containerRect.width + 'px',\r\n\t\t\t\t\theight: this.containerRect.height + 'px'\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn {};\r\n\t\t},\r\n\t\trotateAngle(){\r\n\t\t\tconst angel = Number(this.rotate)\r\n\t\t\tif(isNaN(angel)){\r\n\t\t\t\treturn 0\r\n\t\t\t}else{\r\n\t\t\t\treturn angel % 360\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tstartAnim() {\r\n\t\t\tthis.stopAnim();\r\n\t\t\tthis.anim = true;\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\tthis.anim = false;\r\n\t\t\t}, 200);\r\n\t\t},\r\n\t\tstopAnim() {\r\n\t\t\tthis.anim = false;\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t},\r\n\t\timageInit(src) {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '载入中...'\r\n\t\t\t});\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t\tsrc,\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tthis.imageInfo = res;\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.getContainer().then(rect => {\r\n\t\t\t\t\t\t\tthis.containerRect = rect;\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (err) => {\r\n\t\t\t\t\tthis.$emit('loadFail',err);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '图片下载失败!',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcomplete(res) {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tinitCropper() {\r\n\t\t\tconst imageRate = this.imageInfo.width / this.imageInfo.height;\r\n\t\t\tconst containerRate = this.containerRect.width / this.containerRect.height;\r\n\t\t\tconst imageRect = {};\r\n\t\t\tlet cropperRate = this.ratio;\r\n\t\t\tif (cropperRate == 0) {\r\n\t\t\t\tif (this.cropperRect) {\r\n\t\t\t\t\tcropperRate = this.cropperRect.width / this.cropperRect.height;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcropperRate = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst cropperRect = {};\r\n\t\t\tif (containerRate > cropperRate) {\r\n\t\t\t\tcropperRect.height = this.containerRect.height * 0.85;\r\n\t\t\t\tcropperRect.width = cropperRect.height * cropperRate;\r\n\t\t\t} else {\r\n\t\t\t\tcropperRect.width = this.containerRect.width * 0.85;\r\n\t\t\t\tcropperRect.height = cropperRect.width / cropperRate;\r\n\t\t\t}\r\n\t\t\tif (cropperRate > imageRate) {\r\n\t\t\t\timageRect.width = cropperRect.width;\r\n\t\t\t\timageRect.height = imageRect.width / imageRate;\r\n\t\t\t} else {\r\n\t\t\t\timageRect.height = cropperRect.height;\r\n\t\t\t\timageRect.width = imageRect.height * imageRate;\r\n\t\t\t}\r\n\t\t\timageRect.left = (this.containerRect.width - imageRect.width) / 2;\r\n\t\t\timageRect.top = (this.containerRect.height - imageRect.height) / 2;\r\n\t\t\tcropperRect.left = imageRect.left + (imageRect.width - cropperRect.width) / 2;\r\n\t\t\tcropperRect.top = imageRect.top + (imageRect.height - cropperRect.height) / 2;\r\n\t\t\treturn {\r\n\t\t\t\timageRect,\r\n\t\t\t\tcropperRect\r\n\t\t\t};\r\n\t\t},\r\n\t\tinit() {\r\n\t\t\tconst {imageRect,cropperRect} = this.initCropper()\r\n\t\t\tif(this.initPosition){\r\n\t\t\t\tconst scale = this.imageInfo.width/imageRect.width;\r\n\t\t\t\tconst {left,top,width,height} = this.initPosition;\r\n\t\t\t\tif(left!==undefined&&top!==undefined&&width!==undefined&&height!==undefined){\r\n\t\t\t\t\tcropperRect.width = width/scale;\r\n\t\t\t\t\tcropperRect.height = height/scale;\r\n\t\t\t\t\tcropperRect.left = left/scale;\r\n\t\t\t\t\tcropperRect.top = top/scale;\r\n\t\t\t\t\tthis.$nextTick(this.zoomToFill);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.imageRect = imageRect\r\n\t\t\tthis.cropperRect = cropperRect\r\n\t\t\tthis.operationHistory = [{imageRect,cropperRect}];\r\n\t\t\tthis.operationIndex = 0;\r\n\t\t\tthis.setTarget();\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\tconst systemInfo = uni.getSystemInfoSync();\r\n\t\t\tif (this.canvas2d === false || systemInfo.platform === 'windows' || systemInfo.platform === 'mac') {\r\n\t\t\t\tthis.type2d = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.type2d = true;\r\n\t\t\t\tthis.pixel = systemInfo.pixelRatio;\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\t\t\t//非微信小程序端强制关闭canvas2d模式\r\n\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\tthis.type2d = false;\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef  MP-TOUTIAO || MP-LARK || MP-ALIPAY\r\n\t\t\tthis.type2d = this.canvas2d;\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\t// 设置目标图像的大小\r\n\t\tsetTarget(){\r\n\t\t\tconst ratio = this.cropperRect.width / this.cropperRect.height;\r\n\t\t\tif (!!this.dWidth) {\r\n\t\t\t\tthis.target = {\r\n\t\t\t\t\twidth: this.dWidth,\r\n\t\t\t\t\theight: this.dWidth / (ratio || 1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst width = Math.min(this.maxWidth, this.cropperRect.width * (this.imageInfo.width / this.imageRect.width));\r\n\t\t\t\tthis.target = {\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight: width / (ratio || 1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\taddHistory({imageRect,cropperRect}){\r\n\t\t\tif(this.operationIndex!==this.operationHistory.length-1){\r\n\t\t\t\tthis.operationHistory = this.operationHistory.slice(0,this.operationIndex)\r\n\t\t\t}\r\n\t\t\tthis.operationHistory.push({\r\n\t\t\t\timageRect,\r\n\t\t\t\tcropperRect\r\n\t\t\t});\r\n\t\t\tif (this.operationHistory.length > 10) {\r\n\t\t\t\tthis.operationHistory.shift();\r\n\t\t\t}\r\n\t\t\tthis.operationIndex = this.operationHistory.length - 1;\r\n\t\t},\r\n\t\tupdateData(data) {\r\n\t\t\tthis.imageRect = data.imageRect\r\n\t\t\tthis.cropperRect = data.cropperRect\r\n\t\t\tthis.addHistory(data);\r\n\t\t\tthis.setTarget();\r\n\t\t\tif (this.autoZoom) {\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\tthis.zoomToFill();\r\n\t\t\t\t}, 600);\r\n\t\t\t}\r\n\t\t\tconst {imageRect,cropperRect} = data\r\n\t\t\tconst scale = imageRect.width/this.imageInfo.width\r\n\t\t\tthis.$emit('change', {\r\n\t\t\t\tleft: (cropperRect.left - imageRect.left) /scale,\r\n\t\t\t\ttop: (cropperRect.top - imageRect.top) / scale,\r\n\t\t\t\twidth: cropperRect.width / scale,\r\n\t\t\t\theight: cropperRect.height / scale\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetContainer() {\r\n\t\t\tif (this.containerSize !== null && typeof this.containerSize == 'object') {\r\n\t\t\t\tconst { width, height } = this.containerSize;\r\n\t\t\t\treturn Promise.resolve({\r\n\t\t\t\t\twidth: parseUnit(width),\r\n\t\t\t\t\theight: parseUnit(height)\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn new Promise(resolve => {\r\n\t\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\t\tquery\r\n\t\t\t\t\t\t.select('.mainContent')\r\n\t\t\t\t\t\t.boundingClientRect(rect => {\r\n\t\t\t\t\t\t\tresolve(rect);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.exec();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tzoomToFill() {\r\n\t\t\tthis.startAnim();\r\n\t\t\tconst beforeCropper = {\r\n\t\t\t\t...this.cropperRect\r\n\t\t\t};\r\n\t\t\tconst operation = {\r\n\t\t\t\timageRect:this.imageRect,\r\n\t\t\t\tcropperRect:this.cropperRect\r\n\t\t\t};\r\n\t\t\tthis.cropperRect = this.initCropper().cropperRect;\r\n\t\t\tconst scale = this.cropperRect.width / beforeCropper.width;\r\n\t\t\tconst ox = beforeCropper.left - this.imageRect.left;\r\n\t\t\tconst oy = beforeCropper.top - this.imageRect.top;\r\n\t\t\tthis.imageRect = {\r\n\t\t\t\twidth: this.imageRect.width * scale,\r\n\t\t\t\theight: this.imageRect.height * scale,\r\n\t\t\t\tleft: this.imageRect.left + (this.cropperRect.left - beforeCropper.left) - (scale - 1) * ox,\r\n\t\t\t\ttop: this.imageRect.top + (this.cropperRect.top - beforeCropper.top) - (scale - 1) * oy\r\n\t\t\t};\r\n\t\t},\r\n\t\tonTouchStart() {\r\n\t\t\tthis.stopAnim();\r\n\t\t},\r\n\t\t// 撤销\r\n\t\tundo() {\r\n\t\t\tif (this.operationIndex > 0) {\r\n\t\t\t\tthis.operationIndex--;\r\n\t\t\t\tthis.imageRect = this.operationHistory[this.operationIndex].imageRect;\r\n\t\t\t\tthis.cropperRect = this.operationHistory[this.operationIndex].cropperRect;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t// 重做\r\n\t\tresume() {\r\n\t\t\tif (this.operationIndex < this.operationHistory.length - 1) {\r\n\t\t\t\tthis.operationIndex++;\r\n\t\t\t\tthis.imageRect = this.operationHistory[this.operationIndex].imageRect;\r\n\t\t\t\tthis.cropperRect = this.operationHistory[this.operationIndex].cropperRect;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tasync drawImage(ctx,image,x,y,w,h){\r\n\t\t\tif (this.type2d) {\r\n\t\t\t\tawait new Promise(resolve => (image.onload = resolve));\r\n\t\t\t\tctx.drawImage(image, x * this.pixel, y * this.pixel, w * this.pixel, h * this.pixel);\r\n\t\t\t} else {\r\n\t\t\t\tconst path = await new Promise((resolve)=>{\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc:image,\r\n\t\t\t\t\t\tsuccess({path}){\r\n\t\t\t\t\t\t\tresolve(path)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tctx.drawImage(path, x * this.pixel, y * this.pixel, w * this.pixel, h * this.pixel);\r\n\t\t\t\tawait new Promise((resolve) => ctx.draw(false,resolve));\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync crop() {\r\n\t\t\tlet ctx;\r\n\t\t\tlet canvas;\r\n\t\t\tthis.$emit('cropStart')\r\n\t\t\tthis.setTarget()\r\n\t\t\tif (this.type2d) {\r\n\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\tcanvas = await new Promise(resolve =>\r\n\t\t\t\t\tquery\r\n\t\t\t\t\t\t.select('.bt-canvas')\r\n\t\t\t\t\t\t.node(({ node }) => resolve(node))\r\n\t\t\t\t\t\t.exec()\r\n\t\t\t\t);\r\n\t\t\t\tcanvas.width = this.target.width * this.pixel;\r\n\t\t\t\tcanvas.height = this.target.height * this.pixel;\r\n\t\t\t\tctx = canvas.getContext('2d');\r\n\t\t\t\t// #ifdef MP-TOUTIAO\r\n\t\t\t\tif(this.type2d){\r\n\t\t\t\t\tconsole.warn(\"请注意：目前头条系小程序暂时无法使用2d canvas保存图片，建议换成V1版本\")\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t} else {\r\n\t\t\t\tctx = uni.createCanvasContext(this.canvasId,this);\r\n\t\t\t}\r\n\t\t\tconst scale = this.cropperRect.width / this.target.width;\r\n\t\t\tconst dx = (this.cropperRect.left - this.imageRect.left) / scale;\r\n\t\t\tconst dy = (this.cropperRect.top - this.imageRect.top) / scale;\r\n\t\t\tlet image;\r\n\t\t\tif(this.type2d){\r\n\t\t\t\timage = canvas.createImage()\r\n\t\t\t\timage.src = this.imageSrc;\r\n\t\t\t}else{\r\n\t\t\t\timage = this.imageSrc;\r\n\t\t\t}\r\n\t\t\tconst x = -dx,\r\n\t\t\t\ty = -dy,\r\n\t\t\t\tw = this.imageRect.width / scale,\r\n\t\t\t\th = this.imageRect.height / scale;\r\n\t\t\tctx.save();\r\n\t\t\tctx.translate(x + w / 2, y + h / 2);\r\n\t\t\tctx.rotate((this.rotateAngle * Math.PI) / 180);\r\n\t\t\tctx.translate(-(x + w / 2), -(y + h / 2));\r\n\t\t\tawait this.drawImage(ctx,image, x, y, w, h);\r\n\t\t\tctx.restore();\r\n\t\t\tif (this.mask !== '') {\r\n\t\t\t\tlet imageData;\r\n\t\t\t\tif (this.type2d) {\r\n\t\t\t\t\timageData = ctx.getImageData(0, 0, this.target.width, this.target.height);\r\n\t\t\t\t} else {\r\n\t\t\t\t\timageData = await new Promise(resolve => {\r\n\t\t\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t\t\t\tcanvasId: this.canvasId,\r\n\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\twidth: this.target.width,\r\n\t\t\t\t\t\t\theight: this.target.height,\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tresolve(res);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},this);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tctx.clearRect(0, 0, this.target.width, this.target.height);\r\n\t\t\t\tif(this.type2d){\r\n\t\t\t\t\timage.src = this.mask;\r\n\t\t\t\t}else{\r\n\t\t\t\t\timage = this.mask;\r\n\t\t\t\t}\r\n\t\t\t\tawait this.drawImage(ctx,image, 0, 0, this.target.width, this.target.height);\r\n\t\t\t\tlet maskData;\r\n\t\t\t\tif (this.type2d) {\r\n\t\t\t\t\tmaskData = ctx.getImageData(0, 0, this.target.width, this.target.height);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmaskData = await new Promise((resolve,reject) => {\r\n\t\t\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t\t\t\tcanvasId: this.canvasId,\r\n\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\twidth: this.target.width,\r\n\t\t\t\t\t\t\theight: this.target.height,\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tresolve(res);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},this);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tctx.clearRect(0, 0, this.target.width, this.target.height);\r\n\t\t\t\tfor (let index = 3; index < maskData.data.length; index += 4) {\r\n\t\t\t\t\tconst alpha = maskData.data[index];\r\n\t\t\t\t\tif (alpha !== 0) {\r\n\t\t\t\t\t\timageData.data[index] = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.type2d) {\r\n\t\t\t\t\tctx.putImageData(imageData, 0, 0);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tawait new Promise(resolve => {\r\n\t\t\t\t\t\tuni.canvasPutImageData({\r\n\t\t\t\t\t\t\tcanvasId: this.canvasId,\r\n\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\twidth: imageData.width,\r\n\t\t\t\t\t\t\theight: imageData.height,\r\n\t\t\t\t\t\t\tdata: imageData.data,\r\n\t\t\t\t\t\t\tcomplete: res => {\r\n\t\t\t\t\t\t\t\tresolve(res);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},this);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn new Promise((resolve,reject) => {\r\n\t\t\t\tconst params = {};\r\n\t\t\t\tif (this.type2d) {\r\n\t\t\t\t\tparams.canvas = canvas;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparams.canvasId = this.canvasId;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t...params,\r\n\t\t\t\t\tdestWidth: this.target.width,\r\n\t\t\t\t\tdestHeight: this.target.height,\r\n\t\t\t\t\tquality: Number(this.quality) || 1,\r\n\t\t\t\t\tfileType: this.fileType,\r\n\t\t\t\t\tsuccess: ({ tempFilePath }) => {\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tvar arr = tempFilePath.split(',');\r\n\t\t\t\t\t\tvar mime = arr[0].match(/:(.*?);/)[1];\r\n\t\t\t\t\t\tvar bstr = atob(arr[1]);\r\n\t\t\t\t\t\tvar n = bstr.length;\r\n\t\t\t\t\t\tvar u8arr = new Uint8Array(n);\r\n\t\t\t\t\t\tfor (var i = 0; i < n; i++) {\r\n\t\t\t\t\t\t\tu8arr[i] = bstr.charCodeAt(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar url = URL || webkitURL;\r\n\t\t\t\t\t\tresolve(\r\n\t\t\t\t\t\t\turl.createObjectURL(\r\n\t\t\t\t\t\t\t\tnew Blob([u8arr], {\r\n\t\t\t\t\t\t\t\t\ttype: mime\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\tresolve(tempFilePath);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tconsole.log('保存失败，错误信息：',err);\r\n\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t},this);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n<!-- #ifdef APP-VUE || MP-WEIXIN || MP-QQ || H5 -->\r\n<script module=\"wxsModule\" lang=\"wxs\">\r\nvar startTouchs = [];\r\nvar startDistance = 0;\r\nvar touchCenter = [];\r\nvar ratio = 0;\r\nvar imageInstance = null;\r\nvar cropperInstance = null;\r\nvar touchType = \"\";\r\nvar touchInstance = null;\r\nvar cropperRect = null;\r\nvar imageRect = null;\r\n// 旋转角度\r\nvar rotateAngle = 0;\r\n// 操作时改变的对象\r\nvar changes = {\r\n\timageRect: null,\r\n\tcropperRect: null\r\n}\r\n\r\nfunction updateImageStyle() {\r\n\tvar imageRect = changes.imageRect\r\n\timageInstance.setStyle({\r\n\t\tleft: imageRect.left + 'px',\r\n\t\ttop: imageRect.top + 'px',\r\n\t\twidth: imageRect.width + 'px',\r\n\t\theight: imageRect.height + 'px',\r\n\t\ttransform: 'rotate(' + rotateAngle + 'deg)'\r\n\t})\r\n}\r\n\r\nfunction updateCopperStyle() {\r\n\tvar cropperRect = changes.cropperRect\r\n\tcropperInstance.setStyle({\r\n\t\tleft: cropperRect.left + \"px\",\r\n\t\ttop: cropperRect.top + \"px\",\r\n\t\twidth: cropperRect.width + \"px\",\r\n\t\theight: cropperRect.height + \"px\"\r\n\t})\r\n}\r\n\r\nfunction imageScale(scaleRate) {\r\n\tvar cw = imageRect.width * (scaleRate - 1)\r\n\tvar ch = imageRect.height * (scaleRate - 1)\r\n\tchanges.imageRect = {\r\n\t\twidth: imageRect.width + cw,\r\n\t\theight: imageRect.height + ch,\r\n\t\tleft: imageRect.left - cw * (touchCenter[0]),\r\n\t\ttop: imageRect.top - ch * (touchCenter[1])\r\n\t}\r\n}\r\nfunction getImageRotateSizeChange(w,h){\r\n\tvar cw = h*Math.sin(rotateAngle/180 * Math.PI)\r\n\tvar ch = w*Math.sin(rotateAngle/180 * Math.PI)\r\n\treturn {cw,ch}\r\n}\r\n// 角度转弧度\r\nfunction ang2deg(ang){\r\n\treturn ang/180*Math.PI\r\n}\r\n// 计算旋转后真实的图片大小\r\nfunction getRealSize(){\r\n\tvar w = changes.imageRect.width\r\n\tvar h = changes.imageRect.height\r\n\tvar l =  changes.imageRect.left\r\n\tvar t =  changes.imageRect.top\r\n\t// 内斜边\r\n\tvar R = Math.sqrt(w*w+h*h)\r\n\tvar angle = Math.atan(h/w) / Math.PI * 180\r\n\tvar rorate = rotateAngle%90\r\n\tvar direct = Math.floor(rotateAngle/90)\r\n\tvar width = R*Math.cos(ang2deg(angle-rorate))\r\n\tvar height = R*Math.sin(ang2deg(angle+rorate))\r\n\tif(direct % 2 === 1){\r\n\t\tvar temp = width\r\n\t\twidth = height\r\n\t\theight = temp\r\n\t}\r\n\treturn {\r\n\t\twidth: width,\r\n\t\theight: height,\r\n\t\tleft: l - (width - w)/2,\r\n\t\ttop: t - (height - h)/2,\r\n\t\tdw: width - w,\r\n\t\tdh: height - h\r\n\t}\r\n}\r\nmodule.exports = {\r\n\ttouchStart: function (ev, oi) {\r\n\t\t// #ifdef APP-PLUS || H5\r\n\t\tev.preventDefault();\r\n\t\tev.stopPropagation();\r\n\t\t// #endif\r\n\t\ttouchInstance = ev.instance;\r\n\t\tvar dataSet = ev.instance.getDataset()\r\n\t\ttouchType = dataSet.type;\r\n\t\tstartTouchs = ev.touches;\r\n\t\toi.callMethod('onTouchStart')\r\n\t\tif (startTouchs.length == 2) {\r\n\t\t\ttouchType = \"image\"\r\n\t\t\tvar x1 = startTouchs[0].clientX\r\n\t\t\tvar y1 = startTouchs[0].clientY\r\n\t\t\tvar x2 = startTouchs[1].clientX\r\n\t\t\tvar y2 = startTouchs[1].clientY\r\n\t\t\tvar distance = Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)\r\n\t\t\tstartDistance = Math.sqrt(distance)\r\n\t\t\tvar leftPercent = ((x1 + x2) / 2 - imageRect.left) / imageRect.width\r\n\t\t\tvar topPercent = ((y1 + y2) / 2 - imageRect.top) / imageRect.height\r\n\t\t\ttouchCenter = [leftPercent, topPercent]\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\ttouchMove: function (ev, io) {\r\n\t\tif (touchType == \"\") return false\r\n\t\t// #ifdef H5\r\n\t\tev.preventDefault();\r\n\t\tev.stopPropagation();\r\n\t\t// #endif\r\n\t\tvar touches = ev.touches;\r\n\t\tvar changeX1 = touches[0].clientX - startTouchs[0].clientX;\r\n\t\tvar changeY1 = touches[0].clientY - startTouchs[0].clientY;\r\n\t\tif (startTouchs.length == 1) {\r\n\t\t\tif (touchType === 'image') {\r\n\t\t\t\tchanges.imageRect.left = imageRect.left + changeX1;\r\n\t\t\t\tchanges.imageRect.top = imageRect.top + changeY1;\r\n\t\t\t\tupdateImageStyle()\r\n\t\t\t} else if (touchType === 'controller') {\r\n\t\t\t\tvar directionX = 0;\r\n\t\t\t\tif (touchInstance.hasClass('left')) {\r\n\t\t\t\t\tdirectionX = -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (touchInstance.hasClass('right')) {\r\n\t\t\t\t\tdirectionX = 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar directionY = 0;\r\n\t\t\t\tif (touchInstance.hasClass('top')) {\r\n\t\t\t\t\tdirectionY = -1\r\n\t\t\t\t}\r\n\t\t\t\tif (touchInstance.hasClass('bottom')) {\r\n\t\t\t\t\tdirectionY = 1\r\n\t\t\t\t}\r\n\t\t\t\tvar changeX = changeX1 * directionX;\r\n\t\t\t\tvar changeY = changeY1 * directionY;\r\n\t\t\t\t// 比例缩放控制\r\n\t\t\t\tif (ratio !== 0) {\r\n\t\t\t\t\tif (directionX * directionY !== 0) {\r\n\t\t\t\t\t\tif (changeX / ratio > changeY) {\r\n\t\t\t\t\t\t\tchangeY = changeX / ratio\r\n\t\t\t\t\t\t\tchangeX = changeY * ratio\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchangeX = changeY * ratio\r\n\t\t\t\t\t\t\tchangeY = changeX / ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (directionX == 0) {\r\n\t\t\t\t\t\t\tchangeX = changeY * ratio\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchangeY = changeX / ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvar realSize = getRealSize()\r\n\t\t\t\tvar width = cropperRect.width + changeX\r\n\t\t\t\tvar height = cropperRect.height + changeY\r\n\t\t\t\t// var imageRight = imageRect.left + imageRect.width\r\n\t\t\t\t// var imageBottom = imageRect.top + imageRect.height\r\n\t\t\t\tvar imageRight = realSize.left+realSize.width\r\n\t\t\t\tvar imageBottom = realSize.top+realSize.height\r\n\t\t\t\tif (directionX != -1) {\r\n\t\t\t\t\tif (cropperRect.left + width > imageRight) {\r\n\t\t\t\t\t\twidth = imageRight - cropperRect.left\r\n\t\t\t\t\t\tif (ratio !== 0) {\r\n\t\t\t\t\t\t\theight = width / ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar cLeft = cropperRect.left - changeX\r\n\t\t\t\t\tif (cLeft < realSize.left) {\r\n\t\t\t\t\t\twidth = cropperRect.left + cropperRect.width - realSize.left\r\n\t\t\t\t\t\tif (ratio !== 0) {\r\n\t\t\t\t\t\t\theight = width / ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 判断是否触底\r\n\t\t\t\tif (directionY != -1) {\r\n\t\t\t\t\tif (cropperRect.top + height > imageBottom) {\r\n\t\t\t\t\t\theight = imageBottom - cropperRect.top\r\n\t\t\t\t\t\tif (ratio !== 0) {\r\n\t\t\t\t\t\t\twidth = height * ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar cTop = cropperRect.top - changeY\r\n\t\t\t\t\tif (cTop < realSize.top) {\r\n\t\t\t\t\t\theight = cropperRect.top + cropperRect.height - realSize.top\r\n\t\t\t\t\t\tif (ratio !== 0) {\r\n\t\t\t\t\t\t\twidth = height * ratio\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (directionX == -1) {\r\n\t\t\t\t\tchanges.cropperRect.left = cropperRect.left + cropperRect.width - width\r\n\t\t\t\t}\r\n\t\t\t\tif (directionY == -1) {\r\n\t\t\t\t\tchanges.cropperRect.top = cropperRect.top + cropperRect.height - height\r\n\t\t\t\t}\r\n\t\t\t\t// 边界控制\r\n\t\t\t\tchanges.cropperRect.width = width\r\n\t\t\t\tchanges.cropperRect.height = height\r\n\t\t\t\tupdateCopperStyle()\r\n\t\t\t}\r\n\t\t} else if (touches.length == 2 && startTouchs.length == 2) {\r\n\t\t\tvar changeX2 = touches[0].clientX - touches[1].clientX;\r\n\t\t\tvar changeY2 = touches[0].clientY - touches[1].clientY;\r\n\t\t\tvar distance = Math.pow(changeX2, 2) + Math.pow(changeY2, 2)\r\n\t\t\tdistance = Math.sqrt(distance)\r\n\t\t\t// 放大比例\r\n\t\t\tvar scaleRate = distance / startDistance\r\n\t\t\timageScale(scaleRate)\r\n\t\t\tupdateImageStyle()\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\ttouchEnd: function (ev, oi) {\r\n\t\tif (touchType === \"image\") {\r\n\t\t\tvar cropperLeft = cropperRect.left\r\n\t\t\tvar cropperRight = cropperRect.left + cropperRect.width\r\n\t\t\tvar cropperTop = cropperRect.top\r\n\t\t\tvar cropperBottom = cropperTop + cropperRect.height\r\n\t\t\tvar cropperRate = cropperRect.width / cropperRect.height\r\n\t\t\tvar realSize = getRealSize()\r\n\t\t\tvar rate = realSize.width / realSize.height\r\n\t\t\tif (realSize.width < cropperRect.width || realSize.height < cropperRect.height) {\r\n\t\t\t\tvar scale = 1\r\n\t\t\t\tif (rate < cropperRate) {\r\n\t\t\t\t\tscale = cropperRect.width / realSize.width\r\n\t\t\t\t} else {\r\n\t\t\t\t\tscale = cropperRect.height / realSize.height\r\n\t\t\t\t}\r\n\t\t\t\timageRect.width = changes.imageRect.width\r\n\t\t\t\timageRect.height = changes.imageRect.height\r\n\t\t\t\timageScale(scale)\r\n\t\t\t}\r\n\t\t\t// 边界控制start\r\n\t\t\tif (cropperLeft < realSize.left) {\r\n\t\t\t\tchanges.imageRect.left = cropperLeft + realSize.dw/2\r\n\t\t\t}\r\n\t\t\tif (cropperRight > realSize.left + realSize.width) {\r\n\t\t\t\tchanges.imageRect.left = cropperRight - realSize.width + realSize.dw/2\r\n\t\t\t}\r\n\t\t\tif (cropperTop < realSize.top) {\r\n\t\t\t\tchanges.imageRect.top = cropperTop + realSize.dh/2\r\n\t\t\t}\r\n\t\t\tif (cropperBottom > realSize.top + realSize.height) {\r\n\t\t\t\tchanges.imageRect.top = cropperBottom - realSize.height + realSize.dh/2\r\n\t\t\t}\r\n\t\t\t// 边界控制end\r\n\t\t\tupdateImageStyle()\r\n\t\t}\r\n\t\toi.callMethod('updateData', {\r\n\t\t\tcropperRect: changes.cropperRect,\r\n\t\t\timageRect: changes.imageRect,\r\n\t\t})\r\n\t\ttouchType = \"\"\r\n\t\tstartTouchs = []\r\n\t\treturn false;\r\n\t},\r\n\t// 将逻辑层的图像变换同步过来\r\n\t// 裁剪比例变化\r\n\tchangeRatio: function (value) {\r\n\t\tratio = value\r\n\t},\r\n\tchangeRotateAngle:function (value){\r\n\t\trotateAngle = value;\r\n\t\tif(imageInstance){\r\n\t\t\tupdateImageStyle()\r\n\t\t}\r\n\t\tvar realSize = getRealSize()\r\n\t},\r\n\tchangeImageRect: function (value, oldValue, oi) {\r\n\t\tif (value) {\r\n\t\t\timageRect = value;\r\n\t\t\tchanges.imageRect = {\r\n\t\t\t\tleft: value.left,\r\n\t\t\t\ttop: value.top,\r\n\t\t\t\twidth: value.width,\r\n\t\t\t\theight: value.height\r\n\t\t\t};\r\n\t\t\t// #ifndef MP-WEIXIN || MP-QQ\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\timageInstance = oi.selectComponent('.mainContent > .image')\r\n\t\t\t\tupdateImageStyle();\r\n\t\t\t});\r\n\t\t\t// #endif\r\n\t\t\t// #ifdef MP-WEIXIN || MP-QQ\r\n\t\t\timageInstance = oi.selectComponent('.mainContent > .image')\r\n\t\t\tupdateImageStyle();\r\n\t\t\t// #endif\r\n\t\t}\r\n\t},\r\n\tchangeCropper: function (value, oldValue, oi) {\r\n\t\tif (value) {\r\n\t\t\tcropperRect = value\r\n\t\t\tchanges.cropperRect = {\r\n\t\t\t\tleft: value.left,\r\n\t\t\t\ttop: value.top,\r\n\t\t\t\twidth: value.width,\r\n\t\t\t\theight: value.height\r\n\t\t\t}\r\n\t\t\t// #ifdef H5 || APP-VUE\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t// #endif\r\n\t\t\t\tcropperInstance = oi.selectComponent('.mainContent > .cropper')\r\n\t\t\t\tupdateCopperStyle()\r\n\t\t\t// #ifdef H5 || APP-VUE\r\n\t\t\t});\r\n\t\t\t// #endif\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n<!-- #endif -->\r\n<style lang=\"scss\" scoped>\r\n.bt-container {\r\n\t// display: flex;\r\n\t// flex-direction: column;\r\n\t// justify-content: space-between;\r\n\theight: 100%;\r\n\tbox-sizing: border-box;\r\n\t// background-color: #0e1319;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\r\n\t.bt-canvas {\r\n\t\tposition: fixed;\r\n\t\tleft: 100%;\r\n\t\ttop: 0;\r\n\t}\r\n\r\n\t.mainContent {\r\n\t\t// flex: 1;\r\n\t\t// flex-shrink:0;\r\n\t\t// margin: 60rpx;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\t// touch-action: none;\r\n\r\n\t\t.image {\r\n\t\t\tposition: absolute;\r\n\t\t\t// will-change: transform;\r\n\t\t\t// transform-origin: center center;\r\n\t\t\twidth: 85%;\r\n\t\t\theight: 85%;\r\n\t\t\twill-change: left, top, width, height;\r\n\t\t}\r\n\r\n\t\t.controller {\r\n\t\t\tposition: absolute;\r\n\t\t\tz-index: 99;\r\n\t\t\tpadding: 10rpx;\r\n\t\t\t$offset: -20rpx;\r\n\r\n\t\t\t&::after {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tfilter: drop-shadow(0 0px 10rpx rgba(0, 0, 0, 0.3));\r\n\t\t\t}\r\n\r\n\t\t\t&.vertical {\r\n\t\t\t\ttop: calc(50% - 30rpx);\r\n\t\t\t}\r\n\r\n\t\t\t&.horizon {\r\n\t\t\t\tleft: calc(50% - 30rpx);\r\n\t\t\t}\r\n\r\n\t\t\t&.left {\r\n\t\t\t\t&::after {\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t\tborder-left: 10rpx solid #fff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tleft: $offset;\r\n\t\t\t}\r\n\r\n\t\t\t&.right {\r\n\t\t\t\t&::after {\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t\tborder-right: 10rpx solid #fff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tright: $offset;\r\n\t\t\t}\r\n\r\n\t\t\t&.top {\r\n\t\t\t\ttop: $offset;\r\n\r\n\t\t\t\t&::after {\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\tborder-top: 10rpx solid #fff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t&.bottom {\r\n\t\t\t\tbottom: $offset;\r\n\r\n\t\t\t\t&::after {\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\tborder-bottom: 10rpx solid #fff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t&.left.bottom,\r\n\t\t\t&.right.bottom,\r\n\t\t\t&.left.top,\r\n\t\t\t&.left.bottom {\r\n\t\t\t\t&::after {\r\n\t\t\t\t\twidth: 30rpx;\r\n\t\t\t\t\theight: 30rpx;\r\n\t\t\t\t\tbackground-color: transparent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.cropper {\r\n\t\t\tposition: absolute;\r\n\t\t\tborder: 1px solid #eee;\r\n\t\t\tbox-sizing: content-box;\r\n\t\t\t// transform-origin: center center;\r\n\t\t\toutline: 999px solid rgba(0, 0, 0, 0.5);\r\n\t\t\twill-change: left, top, width, height;\r\n\r\n\t\t\t// display: contain;\r\n\t\t\t// pointer-events: none;\r\n\t\t\t.mask {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\topacity: 0.5;\r\n\t\t\t}\r\n\r\n\t\t\t.line {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\t// background-color: #eee;\r\n\t\t\t}\r\n\r\n\t\t\t.row {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 0px;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\tborder-top: 1px dashed #007aff;\r\n\t\t\t}\r\n\r\n\t\t\t.col {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\twidth: 0px;\r\n\t\t\t\tborder-left: 1px dashed #007aff;\r\n\t\t\t}\r\n\r\n\t\t\t.row1 {\r\n\t\t\t\ttop: 33%;\r\n\t\t\t}\r\n\r\n\t\t\t.row2 {\r\n\t\t\t\ttop: 66%;\r\n\t\t\t}\r\n\r\n\t\t\t.col1 {\r\n\t\t\t\tleft: 33%;\r\n\t\t\t}\r\n\r\n\t\t\t.col2 {\r\n\t\t\t\tleft: 66%;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// .slot {\r\n\t// \tposition: relative;\r\n\t// \tpadding-top: 20rpx;\r\n\t// }\r\n}\r\n\r\n.anim {\r\n\ttransition: 0.2s;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=style&index=0&id=db75b244&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=style&index=0&id=db75b244&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1709105248537\n      var cssReload = require(\"E:/download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader/index.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=custom&index=0&blockType=script&module=wxsModule&lang=wxs\"; export default mod; export * from \"-!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader/index.js!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../download/HBuilderX.3.99.2023122611/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./bt-cropper.vue?vue&type=custom&index=0&blockType=script&module=wxsModule&lang=wxs\"","export default function (Component) {\n       if(!Component.options.wxsCallMethods){\n         Component.options.wxsCallMethods = []\n       }\n       Component.options.wxsCallMethods.push('onTouchStart')\nComponent.options.wxsCallMethods.push('updateData')\n     }"],"sourceRoot":""}